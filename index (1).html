<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ERKOM - Header Replica</title>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700;800&display=swap" rel="stylesheet">
  <!-- Firebase SDK -->
  <!-- Use compat (namespaced) builds so existing `firebase.*` API works -->
  <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-database-compat.js"></script>
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    
    body {
      font-family: 'Montserrat', system-ui, -apple-system, Segoe UI, Roboto, 'Helvetica Neue', Arial;
      color: #fff;
      background: #111;
    }
    
    .site-header {
      position: relative;
      z-index: 10;
    }
    
    .topbar {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 14px 40px;
      background: #0d0d0d;
      border-bottom: 4px solid rgba(255, 255, 255, 0.03);
    }
    
    .logo img {
      height: 40px;
    }
    
    .stats {
      display: flex;
      gap: 18px;
      align-items: center;
      flex: 1;
      justify-content: center;
    }
    
    .stat {
      font-weight: 700;
      font-size: 14px;
      color: #f5f5f5;
      text-align: center;
    }
    
    .stat span {
      display: block;
      font-weight: 400;
      font-size: 11px;
      color: #9aa0a6;
    }
    
    .auth {
      display: flex;
      gap: 10px;
    }
    
    .btn {
      padding: 8px 14px;
      border-radius: 4px;
      border: 1px solid rgba(255, 255, 255, 0.06);
      background: transparent;
      color: #cfd8dc;
      cursor: pointer;
      font-weight: 700;
    }
    
    .btn.primary {
      background: #0db0ff;
      color: #fff;
      border: 1px solid rgba(13, 176, 255, 0.9);
    }
    
    .btn.secondary {
      background: transparent;
      color: #9fb3c0;
    }
    .btn.admin {
      background: transparent;
      color: #ffc857;
      border: 1px solid rgba(255,200,87,0.12);
      padding: 6px 10px;
      font-size:13px;
    }
    
    .main-nav {
      background: #0b0b0b;
      padding: 12px 40px;
    }
    
    .main-nav ul {
      list-style: none;
      display: flex;
      gap: 24px;
      align-items: center;
    }
    
    .main-nav li {
      color: #bfc6c9;
      font-weight: 700;
      letter-spacing: 0.6px;
      cursor: pointer;
    }
    
    .main-nav li.active {
      color: #1db7ff;
    }
    
    /* FEATURES (below header) */
    .features {
      max-width: 1200px;
      margin: 28px auto;
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 28px;
      padding: 26px 20px;
      align-items: start;
      color: #cfd8dc;
    }

    .feature {
      display: flex;
      gap: 16px;
      align-items: flex-start;
    }

    .feature .icon {
      width: 56px;
      height: 56px;
      background: transparent;
      border: 2px solid #0db0ff;
      border-radius: 10px;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      color: #0db0ff;
      flex-shrink: 0;
    }

    .feature h3 {
      color: #ffffff;
      font-size: 16px;
      margin: 0 0 6px 0;
      font-weight: 800;
    }

    .feature p {
      margin: 0;
      color: #9aa0a6;
      font-size: 14px;
      line-height: 1.5;
    }

    @media (max-width: 900px) {
      .features { grid-template-columns: 1fr; gap: 18px; }
    }

    /* WELCOME SECTION */
    .welcome {
      max-width: 1200px;
      margin: 50px auto;
      padding: 0 20px;
      text-align: center;
      color: #cfd8dc;
    }

    .welcome h2 {
      font-size: 28px;
      color: #ffffff;
      margin-bottom: 16px;
      font-weight: 800;
      letter-spacing: 0.5px;
    }

    .welcome .intro-text {
      font-size: 14px;
      line-height: 1.8;
      color: #9aa0a6;
      margin-bottom: 24px;
      max-width: 900px;
      margin-left: auto;
      margin-right: auto;
    }

    .welcome-tabs {
      display: flex;
      gap: 12px;
      justify-content: center;
      margin-bottom: 24px;
      flex-wrap: wrap;
    }

    .welcome-tabs button {
      padding: 8px 16px;
      border: none;
      background: transparent;
      color: #0db0ff;
      cursor: pointer;
      font-weight: 700;
      font-size: 12px;
      border-bottom: 2px solid transparent;
      transition: border-color 220ms ease;
    }

    .welcome-tabs button:first-child {
      border-bottom: 2px solid #0db0ff;
    }

    .welcome-tabs button:hover {
      border-bottom-color: #0db0ff;
    }

    .welcome .glo36-info {
      font-size: 14px;
      line-height: 1.8;
      color: #9aa0a6;
      max-width: 900px;
      margin: 0 auto;
    }

    .welcome .glo36-info strong {
      color: #0db0ff;
      font-weight: 700;
    }

    /* EXCHANGE SECTION */
    .exchange {
      max-width: 1200px;
      margin: 50px auto;
      padding: 0 20px;
      text-align: center;
      color: #cfd8dc;
    }

    .exchange h2 {
      font-size: 32px;
      color: #ffffff;
      margin-bottom: 12px;
      font-weight: 800;
      letter-spacing: 0.5px;
    }

    .exchange .subtitle {
      font-size: 14px;
      color: #9aa0a6;
      margin-bottom: 28px;
    }

    .exchange-buttons {
      display: flex;
      gap: 12px;
      justify-content: center;
      margin-bottom: 40px;
    }

    .exchange-buttons button {
      padding: 10px 32px;
      border: 1px solid #0db0ff;
      background: transparent;
      color: #0db0ff;
      cursor: pointer;
      font-weight: 700;
      font-size: 14px;
      border-radius: 4px;
      transition: all 220ms ease;
    }

    .exchange-buttons button.primary {
      background: #0db0ff;
      color: #000;
    }

    .exchange-buttons button:hover {
      background: #0db0ff;
      color: #000;
    }

    .exchange-cards {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 20px;
      max-width: 900px;
      margin: 0 auto;
    }

    .exchange-card {
      background: rgba(255, 255, 255, 0.02);
      border: 1px solid rgba(13, 176, 255, 0.2);
      padding: 28px;
      border-radius: 6px;
      text-align: center;
    }

    .exchange-card .label {
      font-size: 12px;
      color: #0db0ff;
      letter-spacing: 1px;
      margin-bottom: 8px;
      font-weight: 700;
    }

    .exchange-card .subtitle-text {
      font-size: 13px;
      color: #9aa0a6;
      margin-bottom: 16px;
    }

    .exchange-card h3 {
      font-size: 20px;
      color: #ffffff;
      margin: 16px 0;
      font-weight: 800;
    }

    .exchange-card button {
      padding: 10px 32px;
      background: #0db0ff;
      color: #000;
      border: none;
      cursor: pointer;
      font-weight: 700;
      font-size: 14px;
      border-radius: 4px;
      transition: background 220ms ease;
    }

    .exchange-card button:hover {
      background: #0a8acc;
    }

    /* DOLLAR RATE SECTION */
    .dollar-rate {
      max-width: 1200px;
      margin: 50px auto;
      padding: 0 20px;
      text-align: center;
      color: #cfd8dc;
    }

    .dollar-rate h2 {
      font-size: 32px;
      color: #ffffff;
      margin-bottom: 12px;
      font-weight: 800;
      letter-spacing: 0.5px;
    }

    .dollar-rate .subtitle {
      font-size: 14px;
      color: #9aa0a6;
      margin-bottom: 28px;
    }

    .rate-calculator {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 12px;
      margin-bottom: 12px;
      flex-wrap: wrap;
    }

    .rate-calculator input,
    .rate-calculator select {
      padding: 10px 12px;
      background: transparent;
      border: 1px solid rgba(255, 255, 255, 0.1);
      color: #ffffff;
      border-radius: 4px;
      font-size: 16px;
      font-weight: 700;
      text-align: center;
      min-width: 80px;
    }

    .rate-calculator input::placeholder {
      color: #9aa0a6;
    }

    .rate-calculator select {
      background: #0db0ff;
      color: #000;
      cursor: pointer;
      font-weight: 700;
      min-width: 100px;
    }

    .rate-calculator select option {
      background: #0b0b0b;
      color: #ffffff;
    }

    .rate-calculator .equals {
      font-weight: 700;
      color: #0db0ff;
      font-size: 18px;
    }

    .rate-note {
      font-size: 12px;
      color: #7a8289;
      margin-top: 8px;
    }

    /* HERO (slider) */
    .hero {
      position: relative;
      height: 560px;
      overflow: hidden;
      display: block;
    }

    .hero-slides {
      position: absolute;
      inset: 0;
    }

    .hero-slides .slide {
      position: absolute;
      inset: 0;
      background-size: cover;
      background-position: center;
      opacity: 0;
      transition: opacity 0.8s ease-in-out;
      will-change: opacity;
    }

    .hero-slides .slide.active {
      opacity: 1;
    }

    .hero-overlay {
      position: absolute;
      inset: 0;
      background: linear-gradient(90deg, rgba(3, 3, 3, 0.6) 0%, rgba(0, 0, 0, 0.35) 50%, rgba(3, 3, 3, 0.6) 100%);
      pointer-events: none;
    }

    .hero-content {
      position: relative;
      text-align: center;
      max-width: 920px;
      padding: 20px;
      margin: 0 auto;
      z-index: 6;
      top: 50%;
      transform: translateY(-50%);
    }

    .hero h1 {
      font-size: 72px;
      letter-spacing: 2px;
      font-weight: 800;
      color: #ffffff;
      margin-bottom: 12px;
      text-transform: uppercase;
    }

    .subtitle {
      font-size: 24px;
      color: #ffd400;
      font-weight: 800;
      margin-bottom: 18px;
      text-shadow: 0 1px 0 rgba(0,0,0,0.6);
    }

    .play-btn {
      display: inline-block;
      padding: 10px 28px;
      border: 2px solid rgba(13,176,255,0.85);
      color: rgba(13,176,255,0.95);
      text-decoration: none;
      font-weight: 700;
      border-radius: 4px;
      background: transparent;
      z-index: 7;
      transition: all 220ms ease;
      letter-spacing: 1px;
    }

    .play-btn:hover {
      background: rgba(13,176,255,0.08);
      color: #fff;
      border-color: rgba(13,176,255,1);
    }

    .hero-arrow {
      position: absolute;
      top: 50%;
      transform: translateY(-50%);
      background: rgba(0,0,0,0.35);
      border: none;
      color: #ffffff;
      font-size: 36px;
      cursor: pointer;
      padding: 8px 12px;
      border-radius: 4px;
      z-index: 8;
    }

    .hero-arrow.left { left: 16px; }
    .hero-arrow.right { right: 16px; }
    
    /* FOOTER */
    .site-footer {
      background: #0a0a0a;
      border-top: 1px solid rgba(255, 255, 255, 0.05);
      padding: 40px 20px;
    }
    
    .footer-container {
      max-width: 1200px;
      margin: 0 auto;
    }
    
    .visitor-counter {
      text-align: center;
      margin-bottom: 40px;
      padding-bottom: 40px;
      border-bottom: 1px solid rgba(255, 255, 255, 0.05);
    }
    
    .counter-number {
      font-size: 32px;
      font-weight: 700;
      color: #0db0ff;
      margin-bottom: 8px;
    }
    
    .counter-text {
      font-size: 13px;
      color: #f4a460;
      letter-spacing: 0.5px;
    }
    
    .payment-methods {
      text-align: center;
      margin-bottom: 40px;
      padding-bottom: 40px;
      border-bottom: 1px solid rgba(255, 255, 255, 0.05);
    }
    
    .payment-label {
      font-size: 12px;
      color: #9fb3c0;
      letter-spacing: 0.5px;
      margin-bottom: 14px;
      font-weight: 600;
    }
    
    .payment-icons {
      display: flex;
      gap: 12px;
      justify-content: center;
      flex-wrap: wrap;
    }
    
    .payment-icons {
      display: flex;
      gap: 12px;
      justify-content: center;
      flex-wrap: wrap;
      align-items: center;
    }

    .payment-icons .pay-card {
      width: 64px;
      height: 40px;
      background: #ffffff;
      border-radius: 6px;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      padding: 6px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.18);
    }

    .payment-icons img {
      max-width: 78%;
      max-height: 26px;
      display: block;
      object-fit: contain;
    }
    
    .footer-nav {
      text-align: center;
      margin-bottom: 40px;
      padding-bottom: 40px;
      border-bottom: 1px solid rgba(255, 255, 255, 0.05);
      font-size: 13px;
    }
    
    .footer-nav a {
      color: #0db0ff;
      text-decoration: none;
      margin: 0 4px;
    }
    
    .footer-nav a:hover {
      text-decoration: underline;
    }
    
    .footer-columns {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 40px;
      margin-bottom: 40px;
      padding-bottom: 40px;
      border-bottom: 1px solid rgba(255, 255, 255, 0.05);
    }
    
    .footer-col {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }
    
    .footer-col a {
      font-size: 12px;
      color: #0db0ff;
      text-decoration: none;
    }
    
    .footer-col a:hover {
      text-decoration: underline;
    }
    
    .footer-links {
      text-align: center;
      margin-bottom: 40px;
      padding-bottom: 40px;
      border-bottom: 1px solid rgba(255, 255, 255, 0.05);
      font-size: 12px;
    }
    
    .footer-links a {
      color: #0db0ff;
      text-decoration: none;
      margin: 0 4px;
    }
    
    .footer-links a:hover {
      text-decoration: underline;
    }
    
    .footer-bottom {
      display: flex;
      flex-direction: column;
      gap: 12px;
      align-items: center;
      text-align: center;
      font-size: 12px;
      color: #7a8289;
    }
    
    .footer-legal a {
      color: #0db0ff;
      text-decoration: none;
      margin: 0 4px;
    }
    
    .footer-legal a:hover {
      text-decoration: underline;
    }
    
    .footer-copyright {
      color: #7a8289;
    }
    
    /* Responsive Footer */
    @media (max-width: 768px) {
      .footer-columns {
        grid-template-columns: 1fr;
        gap: 20px;
      }
    }
    
    @media (max-width: 640px) {
      .site-footer {
        padding: 20px 10px;
      }
      
      .counter-number {
        font-size: 24px;
      }
      
      .footer-nav,
      .footer-links {
        font-size: 11px;
      }
    }
    @media (max-width: 1000px) {
      .stats {
        display: none;
      }
      
      .hero {
        height: 460px;
      }
      
      .hero h1 {
        font-size: 40px;
      }
    }
    
    @media (max-width: 640px) {
      .topbar {
        padding: 12px;
      }
      
      .main-nav {
        padding: 10px;
      }
      
      .main-nav ul {
        gap: 12px;
        flex-wrap: wrap;
      }
      
      .hero {
        height: 420px;
      }
      
      .hero h1 {
        font-size: 28px;
      }
      
      .subtitle {
        font-size: 16px;
      }
      
      .play-btn {
        padding: 8px 14px;
      }
      
      .hero-arrow {
        font-size: 36px;
      }
    }
    /* LOTTERY RESULTS STYLES */
    .results-section { background: #0b0b0b; padding: 50px 20px; }
    .results-inner { max-width:1200px; margin:0 auto; }
    .results-inner h2 { text-align:center; color:#fff; font-size:32px; margin-bottom:8px; font-weight:800; }
    .results-sub { text-align:center; color:#9aa0a6; margin-bottom:28px; }
    .results-grid { display:grid; grid-template-columns: repeat(4, 1fr); gap:20px; }
    .result-card { background:transparent; border-radius:8px; overflow:hidden; box-shadow:0 6px 18px rgba(0,0,0,0.4); }
    .result-thumb { height:140px; background-size:cover; background-position:center; border-radius:6px 6px 0 0; }
    .result-body { background:#f2c94c; color:#0b0b0b; padding:14px; border-radius:0 0 6px 6px; position:relative; margin-top:-10px; }
    .result-body h3 { margin:0 0 6px 0; font-size:16px; font-weight:800; }
    .result-meta { font-size:12px; color:#222; margin-bottom:8px; }
    .small-list { list-style:none; padding:0; margin:0 0 12px 0; font-size:13px; color:#111; }
    .small-list li { display:flex; justify-content:space-between; padding:2px 0; }
    .small-list .value { font-weight:700; }
    .more-btn { display:inline-block; margin-top:6px; padding:8px 12px; background:#222; color:#f2c94c; text-decoration:none; border-radius:4px; font-weight:800; }
    .ribbon { position:absolute; top:10px; left:10px; padding:6px 8px; color:#fff; font-weight:700; border-radius:4px; font-size:12px; }
    .ribbon.blue { background:#1e88e5; }
    .ribbon.green { background:#43a047; }
    .ribbon.red { background:#e53935; }
    .ribbon.orange { background:#fb8c00; }
    @media (max-width:1100px){ .results-grid{grid-template-columns:repeat(2,1fr);} }
    @media (max-width:640px){ .results-grid{grid-template-columns:1fr;} .result-thumb{height:180px;} }
    
    /* LATEST WINNERS SECTION */
    .winners-section { background:#0b0b0b; padding:30px 20px; }
    .winners-container { max-width:1200px; margin:0 auto; }
    .winners-header { background:#f2c94c; color:#0b0b0b; padding:12px 20px; font-weight:800; font-size:16px; text-align:center; border-radius:4px; margin-bottom:16px; }
    .winners-list { background:rgba(13,176,255,0.08); border:1px solid rgba(13,176,255,0.2); border-radius:6px; padding:16px; overflow:hidden; }
    .winner-item { display:flex; align-items:center; gap:12px; padding:12px 0; border-bottom:1px solid rgba(255,255,255,0.1); color:#fff; font-size:13px; animation:slideInWinner 0.5s ease-in-out; }
    .winner-item:last-child { border-bottom:none; }
    .winner-icon { font-size:16px; flex-shrink:0; }
    .winner-name { color:#0db0ff; font-weight:700; min-width:80px; }
    .winner-amount { color:#f2c94c; font-weight:800; margin-left:auto; }
    @keyframes slideInWinner { from { opacity:0; transform:translateX(-20px); } to { opacity:1; transform:translateX(0); } }
    @keyframes slideUp { from { transform:translateY(0); } to { transform:translateY(-100%); } }
    @media (max-width:640px){ .winners-list { padding:12px; } .winner-item { font-size:12px; gap:8px; } }
    
    /* LIVE LOTTERY RESULTS */
    .live-results { background:#0a0a0a; padding:40px 20px; }
    .live-results-grid { max-width:1200px; margin:0 auto; display:grid; grid-template-columns:repeat(2,1fr); gap:28px; }
    .live-result-card { background:rgba(13,176,255,0.05); border:1px solid rgba(13,176,255,0.2); padding:16px; border-radius:8px; display:flex; flex-direction:column; max-height:500px; }
    .result-header { display:flex; align-items:center; gap:8px; margin-bottom:8px; flex-shrink:0; }
    .result-logo { font-size:20px; font-weight:800; color:#0db0ff; }
    .globe { font-size:24px; }
    .result-logo-img { height:32px; width:auto; }
    .result-header h3 { color:#ffffff; font-size:14px; font-weight:700; margin:0; }
    .result-divider { height:1px; background:linear-gradient(to right, rgba(255,255,255,0.1), transparent); margin:8px 0; flex-shrink:0; }
    .result-date { color:#0db0ff; font-size:11px; font-weight:700; margin-bottom:8px; flex-shrink:0; }
    .result-numbers { margin-bottom:auto; overflow-y:auto; flex-grow:1; }
    .number-group { margin-bottom:8px; }
    .group-label { color:#9aa0a6; font-size:10px; font-weight:700; margin-bottom:4px; letter-spacing:0.5px; }
    .numbers-row { display:flex; gap:6px; flex-wrap:wrap; }
    .num { display:inline-flex; align-items:center; justify-content:center; width:28px; height:28px; background:#0db0ff; color:#000; font-weight:800; border-radius:4px; font-size:12px; }
    .num.small { width:24px; height:24px; font-size:10px; }
    .dash { color:#9aa0a6; margin:0 2px; font-size:10px; }
    .next-draw { color:#9aa0a6; font-size:10px; font-weight:700; margin-top:auto; margin-bottom:4px; flex-shrink:0; }
    .next-numbers { display:flex; align-items:center; gap:3px; flex-wrap:wrap; flex-shrink:0; }
    @media (max-width:900px){ .live-results-grid{grid-template-columns:1fr;} }
    
    /* RATES TABLE SECTION */
    .rates-section { background:#0b0b0b; padding:40px 20px; }
    .rates-container { max-width:1200px; margin:0 auto; }
    .rates-title { background:#000; color:#fff; padding:16px; text-align:center; font-size:20px; font-weight:800; margin-bottom:20px; border-top:3px solid #f2c94c; }
    .rates-table-wrapper { overflow-x:auto; }
    .rates-table { width:100%; border-collapse:collapse; background:#0a0a0a; }
    .rates-table thead { background:#f2c94c; }
    .rates-table th { color:#0b0b0b; padding:14px; text-align:center; font-weight:800; font-size:13px; border-right:1px solid #e0b900; }
    .rates-table th:last-child { border-right:none; }
    .rates-table td { color:#fff; padding:14px; text-align:center; border:1px solid rgba(255,255,255,0.1); font-size:13px; }
    .rates-table tbody tr { background:#0a0a0a; }
    .rates-table tbody tr:nth-child(even) { background:rgba(13,176,255,0.05); }
    .rates-table tbody tr:hover { background:rgba(13,176,255,0.1); }
    .rates-table td:first-child { color:#0db0ff; font-weight:700; }
    @media (max-width:768px){ .rates-table th, .rates-table td { padding:10px; font-size:12px; } .rates-title { font-size:16px; } }
    
    /* BETTING FORM SECTION */
    .betting-form-section { background:#0b0b0b; padding:30px 20px; }
    .betting-form-container { max-width:900px; margin:0 auto; }
    .betting-tabs { display:flex; gap:8px; margin-bottom:20px; flex-wrap:wrap; }
    .tab-btn { padding:8px 16px; background:#333; color:#9aa0a6; border:1px solid rgba(255,255,255,0.1); border-radius:4px; cursor:pointer; font-weight:700; font-size:12px; transition:all 0.3s ease; }
    .tab-btn.active { background:#ff8c00; color:#fff; border-color:#ff8c00; }
    .tab-btn:hover { background:#444; }
    .betting-form-wrapper { background:#0a0a0a; border-radius:8px; overflow:hidden; }
    .form-header { display:flex; justify-content:space-between; align-items:center; background:#000; padding:16px 20px; border-bottom:2px solid #f2c94c; }
    .form-header h2 { color:#fff; font-size:18px; margin:0; font-weight:800; }
    .balance-display { color:#0db0ff; font-weight:700; font-size:14px; display:flex; align-items:center; gap:8px; }
    .refresh-icon { cursor:pointer; }
    .play-type-section { padding:16px 20px; background:#0a0a0a; border-bottom:1px solid rgba(255,255,255,0.1); }
    .play-type-section h3 { color:#fff; font-size:13px; font-weight:800; margin:0 0 12px 0; }
    .play-type-buttons { display:flex; gap:8px; flex-wrap:wrap; }
    .play-type-btn { padding:8px 14px; background:rgba(13,176,255,0.1); color:#0db0ff; border:1px solid rgba(13,176,255,0.3); border-radius:4px; cursor:pointer; font-weight:700; font-size:12px; transition:all 0.3s ease; }
    .play-type-btn.active { background:#0db0ff; color:#000; border-color:#0db0ff; }
    .play-type-btn:hover { background:rgba(13,176,255,0.2); }
    .betting-form { padding:20px; }
    .form-section { margin-bottom:20px; }
    .section-title { color:#fff; font-weight:800; font-size:13px; margin-bottom:12px; }
    .bet-rows { display:flex; flex-direction:column; gap:10px; }
    .bet-row { display:grid; grid-template-columns:80px 1fr 1fr 1fr; gap:8px; align-items:center; }
    .bet-row label { color:#9aa0a6; font-size:12px; font-weight:700; }
    .bet-input, .amount-input { background:#1a1a1a; border:1px solid rgba(255,255,255,0.1); color:#fff; padding:8px 10px; border-radius:4px; font-size:12px; transition:all 0.3s ease; }
    .bet-input::placeholder, .amount-input::placeholder { color:#555; }
    .bet-input:focus, .amount-input:focus { outline:none; border-color:#0db0ff; background:#1a1a1a; box-shadow:0 0 12px rgba(13,176,255,0.3); transform:scale(1.02); }
    .form-totals { display:grid; grid-template-columns:repeat(3,1fr); gap:12px; margin-bottom:16px; padding:16px; background:rgba(13,176,255,0.05); border-radius:6px; animation:slideUp 0.6s ease; }
    .total-item { display:flex; justify-content:space-between; align-items:center; color:#fff; font-weight:700; font-size:13px; animation:slideLeft 0.5s ease backwards; }
    .total-item:nth-child(1) { animation-delay:0.1s; }
    .total-item:nth-child(2) { animation-delay:0.2s; }
    .total-item:nth-child(3) { animation-delay:0.3s; }
    .total-value { color:#f2c94c; }
    .submit-btn { width:100%; padding:14px; background:#ff8c00; color:#fff; border:none; border-radius:6px; font-weight:800; font-size:14px; cursor:pointer; transition:all 0.3s ease; animation:slideUp 0.7s ease; }
    .submit-btn:hover { background:#e67e00; transform:translateY(-3px); box-shadow:0 8px 20px rgba(255,140,0,0.5); }
    .submit-btn:active { transform:translateY(-1px); }
    @media (max-width:768px){ .bet-row { grid-template-columns:60px 1fr 1fr 1fr; } .form-header { flex-direction:column; gap:10px; } }
    
    /* LOGIN MODAL */
    .login-content { max-width:500px; width:92%; border-color:#0db0ff; animation:popIn 0.5s cubic-bezier(0.34,1.56,0.64,1); }
    .login-header { background:linear-gradient(135deg, #0db0ff 0%, #1db7ff 100%); border-bottom:2px solid #0db0ff; }
    .login-header h2 { color:#fff; }
    .login-body { padding:32px 24px; background:#0a0a0a; }
    .login-title { text-align:center; font-size:20px; font-weight:800; color:#0db0ff; margin-bottom:8px; animation:slideDown 0.4s ease; }
    .login-divider { height:2px; background:linear-gradient(to right, transparent, #0db0ff, transparent); margin:16px 0; animation:slideLeft 0.5s ease; }
    .login-form { animation:slideUp 0.5s ease backwards; }
    .form-group { margin-bottom:18px; animation:slideLeft 0.5s ease backwards; }
    .form-group:nth-child(1) { animation-delay:0.1s; }
    .form-group:nth-child(2) { animation-delay:0.2s; }
    .form-group label { display:block; font-size:12px; color:#9aa0a6; text-transform:uppercase; margin-bottom:6px; font-weight:700; }
    .login-input { width:100%; padding:12px; background:#1a1a1a; border:1px solid rgba(13,176,255,0.2); border-radius:6px; color:#fff; font-size:14px; transition:all 0.3s ease; }
    .login-input:focus { outline:none; border-color:#0db0ff; background:#1a1a1a; box-shadow:0 0 12px rgba(13,176,255,0.4); transform:scale(1.02); }
    .login-btn { width:100%; padding:12px; background:linear-gradient(135deg,#0db0ff,#1db7ff); color:#fff; border:none; border-radius:6px; font-weight:800; font-size:14px; cursor:pointer; transition:all 0.3s ease; animation:slideUp 0.6s ease 0.3s backwards; }
    .login-btn:hover { transform:translateY(-3px); box-shadow:0 8px 20px rgba(13,176,255,0.5); }
    .login-btn:active { transform:translateY(-1px); }
    .login-footer { text-align:center; margin-top:16px; animation:slideUp 0.6s ease 0.4s backwards; }
    
    /* PAYMENT MODAL */
    .modal { position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.85); display:flex; align-items:center; justify-content:center; z-index:1000; backdrop-filter:blur(2px); animation:fadeIn 0.3s ease; }
    .modal.hidden { display:none; }
    .modal-content { background:#0a0a0a; border-radius:12px; max-width:720px; width:90%; border:2px solid #ff8c00; box-shadow:0 10px 40px rgba(255,140,0,0.3); animation:slideDown 0.4s cubic-bezier(0.34,1.56,0.64,1); max-height:90vh; overflow-y:auto; }
    @keyframes slideDown { from { opacity:0; transform:translateY(-40px); } to { opacity:1; transform:translateY(0); } }
    @keyframes fadeIn { from { opacity:0; } to { opacity:1; } }
    @keyframes popIn { from { opacity:0; transform:scale(0.8); } to { opacity:1; transform:scale(1); } }
    @keyframes slideUp { from { opacity:0; transform:translateY(60px); } to { opacity:1; transform:translateY(0); } }
    @keyframes slideLeft { from { opacity:0; transform:translateX(40px); } to { opacity:1; transform:translateX(0); } }
    @keyframes pulse { 0%, 100% { opacity:1; } 50% { opacity:0.6; } }
    @keyframes glow { 0% { box-shadow:0 0 5px rgba(255,140,0,0.3); } 50% { box-shadow:0 0 20px rgba(255,140,0,0.8); } 100% { box-shadow:0 0 5px rgba(255,140,0,0.3); } }
    .modal-header { background:linear-gradient(135deg, #000 0%, #1a0a00 100%); padding:16px 20px; border-bottom:2px solid #ff8c00; display:flex; justify-content:space-between; align-items:center; border-radius:10px 10px 0 0; }
    .modal-header h2 { color:#fff; margin:0; font-size:18px; font-weight:800; }
    .modal-close { background:none; border:none; color:#fff; font-size:28px; cursor:pointer; transition:all 0.2s; }
    .modal-close:hover { color:#ff8c00; transform:rotate(90deg); }
    .payment-summary { padding:20px; background:rgba(13,176,255,0.05); margin:16px; border-radius:6px; border:1px solid rgba(13,176,255,0.2); animation:slideLeft 0.5s ease; }
    .summary-row { display:flex; justify-content:space-between; color:#9aa0a6; font-size:13px; padding:8px 0; animation:slideLeft 0.4s ease backwards; }
    .summary-row:nth-child(1) { animation-delay:0.1s; }
    .summary-row:nth-child(2) { animation-delay:0.2s; }
    .summary-row:nth-child(3) { animation-delay:0.3s; }
    .summary-row:nth-child(4) { animation-delay:0.4s; }
    .summary-row.final { border-top:2px solid #f2c94c; padding-top:12px; color:#fff; font-weight:800; }
    .summary-row.final span:last-child { color:#f2c94c; font-size:16px; }
    .payment-methods-grid { display:grid; grid-template-columns:repeat(2,1fr); gap:12px; padding:0 16px 16px; }
    .payment-method-btn { display:flex; flex-direction:column; align-items:center; gap:8px; padding:16px; background:#1a1a1a; border:2px solid rgba(255,255,255,0.1); border-radius:6px; cursor:pointer; color:#9aa0a6; font-size:12px; font-weight:700; transition:all 0.3s ease; animation:slideUp 0.5s ease backwards; }
    .payment-method-btn:nth-child(1) { animation-delay:0.1s; }
    .payment-method-btn:nth-child(2) { animation-delay:0.2s; }
    .payment-method-btn:nth-child(3) { animation-delay:0.3s; }
    .payment-method-btn:nth-child(4) { animation-delay:0.4s; }
    .payment-method-btn img { height:32px; width:auto; }
    .payment-method-btn:hover { border-color:#ff8c00; background:rgba(255,140,0,0.1); color:#ff8c00; transform:translateY(-4px) scale(1.05); box-shadow:0 8px 16px rgba(255,140,0,0.4); }
    .payment-method-btn:active { transform:translateY(-2px) scale(0.98); }
    .payment-method-btn.selected { border-color:#ff8c00; background:rgba(255,140,0,0.2); color:#ff8c00; animation:glow 1.5s ease infinite; }
    .payment-instruction { padding:0 16px 16px; text-align:center; color:#9aa0a6; font-size:12px; animation:slideUp 0.6s ease; }
    /* RECEIPT MODAL */
    .receipt-content { max-width:640px; width:92%; border-color:#f2c94c; animation:popIn 0.5s cubic-bezier(0.34,1.56,0.64,1); }
    .receipt-header { background:linear-gradient(135deg, #f2c94c 0%, #ffa500 100%); border-bottom:2px solid #f2c94c; }
    .receipt-header h2 { color:#0a0a0a; }
    .receipt-body { padding:24px; background:#0a0a0a; }
    .receipt-title { text-align:center; font-size:18px; font-weight:800; color:#f2c94c; margin-bottom:8px; animation:slideDown 0.4s ease; }
    .receipt-divider { height:1px; background:linear-gradient(to right, transparent, #f2c94c, transparent); margin:12px 0; animation:slideLeft 0.5s ease; }
    .receipt-section { margin:12px 0; animation:slideLeft 0.5s ease backwards; }
    .receipt-section:nth-child(2) { animation-delay:0.05s; }
    .receipt-section:nth-child(3) { animation-delay:0.1s; }
    .receipt-section:nth-child(4) { animation-delay:0.15s; }
    .receipt-label { font-size:12px; color:#9aa0a6; text-transform:uppercase; letter-spacing:0.5px; margin-bottom:4px; }
    .receipt-value { font-size:14px; color:#fff; font-weight:700; }
    .receipt-number { color:#f2c94c; }
    .receipt-amount { color:#0db0ff; font-size:16px; }
    .receipt-status { color:#4caf50; }
    .final-amount { background:rgba(242,201,76,0.1); padding:12px; border-radius:6px; border:1px solid rgba(242,201,76,0.2); animation:slideLeft 0.5s ease; }
    .receipt-footer { text-align:center; padding:12px 0; color:#9aa0a6; font-size:12px; animation:slideUp 0.5s ease; }
    .receipt-print-btn { width:100%; padding:12px; background:#f2c94c; color:#0a0a0a; border:none; border-radius:6px; font-weight:800; font-size:13px; cursor:pointer; transition:all 0.3s ease; margin-top:16px; animation:slideUp 0.6s ease; }
    .receipt-print-btn:hover { background:#ffa500; transform:translateY(-3px); box-shadow:0 8px 16px rgba(242,201,76,0.4); }
    .receipt-print-btn:active { transform:translateY(-1px); }
    .receipt-number-item { display:flex; justify-content:space-between; padding:8px; background:rgba(242,201,76,0.05); border-left:2px solid #f2c94c; margin-bottom:6px; border-radius:3px; font-size:12px; animation:slideLeft 0.5s ease backwards; transition:all 0.3s ease; }
    .receipt-number-item:nth-child(1) { animation-delay:0.1s; }
    .receipt-number-item:nth-child(2) { animation-delay:0.15s; }
    .receipt-number-item:nth-child(3) { animation-delay:0.2s; }
    .receipt-number-item:hover { background:rgba(242,201,76,0.15); transform:translateX(4px); }
    .receipt-number-item span:first-child { color:#fff; font-weight:700; }
    .receipt-number-item span:last-child { color:#f2c94c; font-weight:700; }
    .receipt-security-box { padding:12px; background:rgba(76,175,80,0.08); border:1px solid rgba(76,175,80,0.2); border-radius:6px; margin:12px 0; animation:slideLeft 0.6s ease; }
    /* better mobile scrolling for long receipt lists */
    .receipt-numbers-wrap { max-height:36vh; overflow-y:auto; padding-right:6px; }
    /* ADMIN PANEL */
    .admin-toggle-btn { position:fixed; bottom:20px; right:20px; width:54px; height:54px; background:linear-gradient(135deg,#ff8c00,#ffa500); border-radius:50%; display:flex; align-items:center; justify-content:center; font-size:24px; cursor:pointer; z-index:999; box-shadow:0 4px 12px rgba(255,140,0,0.4); transition:all 0.3s ease; border:none; animation:slideUp 0.6s cubic-bezier(0.34,1.56,0.64,1); }
    .admin-toggle-btn:hover { transform:scale(1.15) rotate(-10deg); box-shadow:0 8px 24px rgba(255,140,0,0.6); }
    .admin-toggle-btn:active { transform:scale(0.95); }
    .admin-panel { position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.9); display:flex; align-items:flex-end; z-index:1500; backdrop-filter:blur(2px); animation:fadeIn 0.3s ease; }
    .admin-panel.hidden { display:none; }
    .admin-panel-content { background:#0a0a0a; width:100%; max-height:80vh; border-radius:16px 16px 0 0; border-top:2px solid #ff8c00; box-shadow:0 -10px 40px rgba(255,140,0,0.3); display:flex; flex-direction:column; overflow:hidden; animation:slideUp 0.5s cubic-bezier(0.34,1.56,0.64,1); }
    .admin-header { background:linear-gradient(135deg,#ff8c00,#ffa500); padding:20px; display:flex; justify-content:space-between; align-items:center; border-radius:16px 16px 0 0; }
    .admin-header h2 { color:#000; margin:0; font-size:18px; font-weight:800; }
    .admin-close { background:none; border:none; color:#000; font-size:28px; cursor:pointer; font-weight:800; transition:all 0.2s; }
    .admin-close:hover { transform:rotate(90deg); }
    .admin-body { padding:20px; overflow-y:auto; flex:1; }
    .pending-payments-section, .approved-payments-section { margin-bottom:24px; animation:slideUp 0.5s ease backwards; }
    .pending-payments-section { animation-delay:0.1s; }
    .approved-payments-section { animation-delay:0.2s; }
    .pending-payments-section h3, .approved-payments-section h3 { color:#fff; font-size:14px; font-weight:800; margin-bottom:12px; }
    .pending-list, .approved-list { display:flex; flex-direction:column; gap:12px; }
    .empty-state { color:#9aa0a6; font-size:12px; text-align:center; padding:16px; }
    .payment-item { background:#1a1a1a; border:1px solid rgba(255,140,0,0.2); border-radius:8px; padding:16px; animation:slideLeft 0.5s ease backwards; transition:all 0.3s ease; }
    .payment-item:hover { background:#252525; border-color:#ff8c00; transform:translateX(4px); box-shadow:0 4px 12px rgba(255,140,0,0.2); }
    .payment-item:nth-child(1) { animation-delay:0.1s; }
    .payment-item:nth-child(2) { animation-delay:0.15s; }
    .payment-item:nth-child(3) { animation-delay:0.2s; }
    .payment-item.pending { border-color:#ffc107; }
    .payment-item.approved { border-color:#4caf50; }
    .payment-item-header { display:flex; justify-content:space-between; margin-bottom:12px; }
    .payment-item-id { color:#f2c94c; font-weight:700; font-size:12px; }
    .payment-item-status { font-size:11px; padding:4px 8px; border-radius:4px; font-weight:700; animation:pulse 2s ease infinite; }
    .payment-item-status.pending { background:#ffc107; color:#000; }
    .payment-item-status.approved { background:#4caf50; color:#fff; }
    .payment-item-details { display:grid; grid-template-columns:1fr 1fr; gap:12px; margin-bottom:12px; font-size:11px; }
    .payment-item-detail { color:#9aa0a6; }
    .payment-item-detail strong { color:#fff; }
    .payment-item-amount { text-align:center; padding:12px; background:rgba(255,140,0,0.1); border-radius:6px; margin-bottom:12px; }
    .payment-item-amount-label { color:#9aa0a6; font-size:11px; }
    .payment-item-amount-value { color:#f2c94c; font-size:16px; font-weight:800; animation:pulse 2s ease infinite; }
    .payment-item-actions { display:flex; gap:8px; }
    .payment-btn { flex:1; padding:8px; border:none; border-radius:4px; font-weight:700; font-size:12px; cursor:pointer; transition:all 0.3s ease; }
    .approve-btn { background:#4caf50; color:#fff; animation:slideUp 0.5s ease backwards; transition:all 0.3s ease; }
    .approve-btn:hover { background:#45a049; transform:translateY(-2px); box-shadow:0 4px 12px rgba(76,175,80,0.4); }
    .approve-btn:active { transform:translateY(0); }
    .reject-btn { background:#f44336; color:#fff; animation:slideUp 0.5s ease backwards; transition:all 0.3s ease; }
    .reject-btn:hover { background:#da190b; transform:translateY(-2px); box-shadow:0 4px 12px rgba(244,67,54,0.4); }
    .reject-btn:active { transform:translateY(0); }
    .payment-btn { flex:1; padding:8px; border:none; border-radius:4px; font-weight:700; font-size:12px; cursor:pointer; transition:all 0.3s ease; }
    @keyframes slideInRight { from { opacity:0; transform:translateX(30px); } to { opacity:1; transform:translateX(0); } }
    @keyframes slideOutRight { from { opacity:1; transform:translateX(0); } to { opacity:0; transform:translateX(30px); } }
    @keyframes spin { from { transform:rotate(0deg); } to { transform:rotate(360deg); } }
    @media (max-width:900px){
      .modal-content { max-width:92%; margin:12px; }
      .receipt-content { max-width:92%; width:100%; }
      .receipt-body { padding:16px; }
      .receipt-title { font-size:16px; }
      .receipt-label { font-size:11px; }
      .receipt-value { font-size:13px; }
      .receipt-number-item { font-size:13px; padding:10px; }
      .payment-methods-grid { grid-template-columns:1fr 1fr; }
      .admin-panel-content { max-height:85vh; }
    }
    @media (max-width:600px){
      .payment-methods-grid { grid-template-columns:1fr; }
      .modal-content { max-width:100%; height:100%; border-radius:0; align-items:flex-start; overflow:auto; }
      .modal-content .modal-header { border-radius:0; }
      .receipt-content { max-width:100%; width:100%; height:100%; border-radius:0; }
      .receipt-body { padding:12px; }
      .receipt-title { font-size:15px; }
      .receipt-label { font-size:10px; }
      .receipt-value { font-size:13px; }
      .receipt-print-btn { padding:10px; font-size:14px; }
      .receipt-numbers-wrap { max-height:40vh; }
      .admin-toggle-btn { width:46px; height:46px; bottom:16px; right:14px; }
      .admin-panel-content { border-radius:12px 12px 0 0; padding-bottom:12px; }
      .payment-item-details { grid-template-columns:1fr; }
      .payment-item-actions { flex-direction:column; }
      .payment-btn { width:100%; }
    }
*** End Patch
    /* Notification styles */
    .site-notification {
      position: fixed;
      top: 20px;
      right: 20px;
      z-index: 4000;
      display: flex;
      flex-direction: column;
      gap: 12px;
      pointer-events: none;
    }
    .site-notification .note {
      pointer-events: auto;
      background: linear-gradient(135deg,#111827,#1f2937);
      color: #fff;
      padding: 14px 18px;
      border-radius: 12px;
      box-shadow: 0 12px 30px rgba(2,6,23,0.6);
      min-width: 280px;
      max-width: 420px;
      font-weight: 700;
      transform-origin: center right;
      display: flex;
      align-items: center;
      gap: 12px;
    }
    .site-notification .note.small { padding:10px 14px; font-weight:600; }
    .note .icon { font-size:20px; width:36px; height:36px; display:inline-flex; align-items:center; justify-content:center; border-radius:8px; }
    .note.success { background: linear-gradient(135deg,#10b981,#059669); }
    .note.warn { background: linear-gradient(135deg,#ff8a00,#ff5a5f); }
    .note.info { background: linear-gradient(135deg,#0db0ff,#1db7ff); }
    .note .text { flex:1; font-size:14px; }

    @keyframes popIn {
      0% { transform: translateY(-18px) scale(.96); opacity:0 }
      60% { transform: translateY(6px) scale(1.02); opacity:1 }
      100% { transform: translateY(0) scale(1); opacity:1 }
    }
    @keyframes popOut {
      0% { transform: translateY(0) scale(1); opacity:1 }
      100% { transform: translateY(-18px) scale(.96); opacity:0 }
    }
    .note.show { animation: popIn 420ms cubic-bezier(.2,.9,.24,1); }
    .note.hide { animation: popOut 300ms ease forwards; }

    /* Responsive / Mobile improvements */
    img { max-width: 100%; height: auto; display: block; }

    .nav-toggle {
      display: none;
      background: transparent;
      border: none;
      color: #cfd8dc;
      font-size: 24px;
      cursor: pointer;
      padding: 6px 8px;
      border-radius: 6px;
    }

    .main-nav ul { transition: all 220ms ease; }

    /* 3-dot menu styles */
    .menu-dot-btn {
      background: transparent;
      border: none;
      color: #cfd8dc;
      font-size: 24px;
      cursor: pointer;
      padding: 6px 10px;
      border-radius: 6px;
      position: relative;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      min-width: 40px;
      min-height: 40px;
      flex-shrink: 0;
    }

    .menu-dot-btn:hover {
      background: rgba(255, 255, 255, 0.1);
    }

    .menu-dropdown {
      position: absolute;
      top: 100%;
      right: 0;
      background: #1a1a1a;
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 6px;
      min-width: 180px;
      margin-top: 8px;
      box-shadow: 0 8px 24px rgba(0, 0, 0, 0.6);
      z-index: 1000;
      display: none;
    }

    .menu-dropdown.open {
      display: block;
    }

    .menu-dropdown a, .menu-dropdown button {
      display: flex;
      align-items: center;
      gap: 10px;
      width: 100%;
      padding: 12px 16px;
      border: none;
      background: transparent;
      color: #cfd8dc;
      cursor: pointer;
      font-size: 14px;
      font-weight: 600;
      text-align: left;
      transition: all 220ms ease;
    }

    .menu-dropdown a:hover, .menu-dropdown button:hover {
      background: rgba(13, 176, 255, 0.1);
      color: #0db0ff;
    }

    /* Receipt History Modal */
    .receipt-history-modal.modal {
      display: none;
    }

    .receipt-history-modal.modal.show {
      display: flex;
    }

    .receipt-history-content {
      max-width: 900px;
      max-height: 80vh;
      overflow-y: auto;
    }

    .receipt-list {
      display: grid;
      gap: 12px;
      max-height: 60vh;
      overflow-y: auto;
      padding: 20px;
    }

    .receipt-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 12px 16px;
      background: rgba(255, 255, 255, 0.02);
      border: 1px solid rgba(13, 176, 255, 0.2);
      border-radius: 6px;
      transition: all 220ms ease;
      gap: 12px;
      flex-wrap: wrap;
    }

    .receipt-item:hover {
      background: rgba(13, 176, 255, 0.08);
      border-color: rgba(13, 176, 255, 0.4);
    }

    .receipt-item-info {
      flex: 1;
      min-width: 150px;
    }

    .receipt-item-number {
      color: #0db0ff;
      font-weight: 700;
      font-size: 14px;
      margin-bottom: 4px;
    }

    .receipt-item-date {
      color: #9aa0a6;
      font-size: 12px;
    }

    .receipt-item-amount {
      color: #0db0ff;
      font-weight: 700;
      font-size: 14px;
      min-width: 80px;
    }

    .receipt-item-status {
      padding: 4px 8px;
      border-radius: 4px;
      font-size: 11px;
      font-weight: 700;
      min-width: 100px;
    }

    .receipt-item-status.approved {
      background: rgba(16, 185, 129, 0.2);
      color: #10b981;
    }

    .receipt-item-status.pending {
      background: rgba(255, 193, 7, 0.2);
      color: #ffc107;
    }

    .receipt-item-btn {
      padding: 6px 12px;
      background: #0db0ff;
      color: #000;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-weight: 700;
      font-size: 12px;
      transition: background 220ms ease;
    }

    .receipt-item-btn:hover {
      background: #0a8acc;
    }

    .empty-receipts {
      text-align: center;
      padding: 40px 20px;
      color: #9aa0a6;
      grid-column: 1 / -1;
    }

    .empty-receipts-icon {
      font-size: 48px;
      margin-bottom: 16px;
    }

    @media (max-width: 900px) {
      .topbar { padding: 12px 16px; }
      .main-nav { padding: 10px 16px; }
      .logo img { height: 36px; }
      .stats { display: none; }
      .auth { gap: 6px; flex-wrap: wrap; }
      .btn { padding: 8px 12px; font-size: 12px; }
      .menu-dot-btn { display: inline-flex !important; }
      .features { margin: 18px 12px; }
      .welcome { margin: 28px 12px; }
      .exchange { margin: 28px 12px; }
      .nav-toggle { display: inline-flex; align-items: center; justify-content: center; }
      .main-nav ul { display: none; flex-direction: column; gap: 10px; }
      .main-nav.open ul { display: flex; }
    }

    @media (max-width: 480px) {
      .welcome h2 { font-size: 22px; }
      .exchange h2 { font-size: 22px; }
      .welcome .intro-text, .welcome .glo36-info, .exchange .subtitle { font-size: 13px; }
      .btn { padding: 8px 10px; font-size: 13px; }
      .exchange-buttons button { padding: 8px 18px; }
    }
      /* Welcome modal styles */
      .welcome-modal-overlay {
        position: fixed;
        inset: 0;
        background: linear-gradient(90deg, rgba(2,6,23,0.7), rgba(6,10,29,0.75));
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 9999;
        backdrop-filter: blur(6px);
        -webkit-backdrop-filter: blur(6px);
        opacity: 0;
        transform: scale(1.02);
        transition: opacity 260ms ease, transform 260ms ease;
      }
      .welcome-modal-overlay.show {
        opacity: 1;
        transform: scale(1);
      }
      .welcome-modal {
        width: 92%;
        max-width: 680px;
        background: linear-gradient(180deg, #0f1724, #081122);
        border: 1px solid rgba(255,255,255,0.04);
        padding: 28px 26px;
        border-radius: 14px;
        color: #e6f6ff;
        box-shadow: 0 20px 60px rgba(2,6,23,0.7);
        text-align: left;
        animation: popIn 260ms cubic-bezier(.2,.9,.2,1);
      }
      .welcome-modal h2 { margin-bottom: 8px; font-size: 22px; color: #9be7ff; }
      .welcome-modal p { margin-bottom: 18px; color: #c9e9ff; opacity: 0.95; line-height:1.5; }
      .welcome-actions { display:flex; gap:12px; justify-content:flex-end; }
      .welcome-actions .btn { padding:10px 16px; border-radius:10px; font-weight:700; }
      .welcome-actions .btn.primary { background: linear-gradient(90deg,#0db0ff,#1db7ff); color:#012; }
      .welcome-actions .btn.ghost { background:transparent; border:1px solid rgba(255,255,255,0.06); color:#dbefff; }
  </style>
</head>
<body>
  <!-- Welcome modal -->
  <div id="welcomeModalOverlay" class="welcome-modal-overlay" aria-hidden="true" style="display:none;">
    <div class="welcome-modal" role="dialog" aria-modal="true" aria-labelledby="welcomeTitle">
      <h2 id="welcomeTitle">Welcome to National Lottery Thailand</h2>
      <p>Welcome! We provide a trusted, secure, and reliable lottery platform with excellent service. Play with confidence knowing your payments are safe and your transactions are transparent. Join thousands of satisfied players today!</p>
      <div style="display:flex;align-items:center;gap:12px;margin-bottom:8px;">
        <div style="width:56px;height:56px;border-radius:10px;background:linear-gradient(135deg,#0db0ff,#1db7ff);display:flex;align-items:center;justify-content:center;color:#012;font-weight:800;font-size:20px;"></div>
        <div style="flex:1;color:#bfeeff;font-size:13px;opacity:0.95;"><strong>Why Us?</strong> Fast payments, trusted service, 24/7 support, and secure transactions. Your best choice for online lottery!</div>
      </div>
      <div class="welcome-actions">
        <button type="button" id="welcomeCloseBtn" class="btn ghost">Close</button>
        <button type="button" id="welcomeOkBtn" class="btn primary">Got It!</button>
      </div>
    </div>
  </div>
  <header class="site-header">
    <div class="topbar">
      <div class="logo">
        <img src="https://i.ibb.co.com/bjV9G9tc/logo.png" alt="logo">
      </div>
      <button class="nav-toggle" aria-label="Toggle navigation"></button>
      <div class="stats">
        <div class="stat">$9,450<span>Last trade price</span></div>
        <div class="stat">+5.26%<span>24 hour price</span></div>
        <div class="stat">$12,820<span>24 hour volume</span></div>
        <div class="stat">2,231,775<span>Active players</span></div>
        <div class="stat">1,063,153<span>Active winners</span></div>
      </div>
      <div class="auth">
        <button class="btn secondary" id="loginBtn" style="display:block !important;">LOG IN</button>
        <button class="btn primary" id="registerBtn" style="display:block !important;">REGISTER</button>
        <button class="btn admin" id="adminHeaderBtn" title="Open Admin Panel"> ADMIN</button>
        <button type="button" class="btn secondary" id="logoutBtn" onclick="doLogout(event);" style="display:none;background:#e74c3c;" title="Logout"> LOGOUT</button>
        <div style="position:relative;">
          <button class="menu-dot-btn" id="menuDotBtn" title="Menu"></button>
          <div class="menu-dropdown" id="menuDropdown">
            <button id="receiptHistoryBtn" title="View all receipts"> Receipt History</button>
            <a href="#" title="Settings"> Settings</a>
            <a href="#" title="Support"> Support</a>
          </div>
        </div>
      </div>
    </div>

    <nav class="main-nav">
      <ul>
        <li class="active">HOME</li>
        <li>LOTTERY</li>
        <li>RESULT</li>
        <li>PRIZES</li>
        <li>CONTACT</li>
        <li>NOTICE</li>
        <li>ABOUT</li>
      </ul>
    </nav>
  </header>

  <script>
    // Show welcome modal on page load
    window.addEventListener('load', function() {
      const overlay = document.getElementById('welcomeModalOverlay');
      if (overlay) {
        overlay.style.display = 'flex';
        setTimeout(() => {
          overlay.classList.add('show');
          overlay.setAttribute('aria-hidden', 'false');
        }, 100);
      }
    });

    // Close welcome modal
    document.addEventListener('click', function(e) {
      const target = e.target;
      if (target && (target.id === 'welcomeOkBtn' || target.id === 'welcomeCloseBtn' || target.id === 'welcomeModalOverlay')) {
        const overlay = document.getElementById('welcomeModalOverlay');
        if (overlay) {
          overlay.classList.remove('show');
          overlay.setAttribute('aria-hidden', 'true');
          setTimeout(() => {
            overlay.style.display = 'none';
          }, 260);
        }
      }
    });
  </script>

  <section class="hero" id="hero">
    <div class="hero-slides">
      <div class="slide active" data-title="GLO36 OFFICE THAILAND" data-subtitle="Tha Sai Amphoe Mueang, Nonthaburi, Th" style="background-image:url('https://i.ibb.co/BKy0N0bV/upscalemedia-transformed.jpg')"></div>
      <div class="slide" data-title="THAI NATIONAL LOTTERY" data-subtitle="Draw Every Month Date 1 &amp; 16, 3:45 PM" style="background-image:url('https://i.ibb.co/LWGGCjp/Whats-App-Image-2025-12-10-at-06-01-02-2a6b5951.jpg')"></div>
      <div class="slide" data-title="SECURE PAYMENTS" data-subtitle="Bingo Draw Every Friday &amp; TOTO Daily" style="background-image:url('https://i.ibb.co/JwG2xgf5/Whats-App-Image-2025-12-10-at-06-06-30-1a92d52a.jpg')"></div>
      <div class="slide" data-title="ONLINE NUMBER BUY SERVICE" data-subtitle="Multiple payment methods supported" style="background-image:url('https://i.ibb.co/ymx4ZSK6/Whats-App-Image-2025-12-10-at-06-06-40-1a9d8a50.jpg')"></div>
      <div class="slide" data-title="JOIN NOW" data-subtitle="Register and win exciting prizes" style="background-image:url('https://i.ibb.co/r2yQfhFz/Whats-App-Image-2025-12-10-at-06-07-59-6967a3b4.jpg')"></div>
    </div>
    <div class="hero-overlay"></div>
    <div class="hero-content">
      <h1>GLO36 OFFICE THAILAND</h1>
      <p class="subtitle">Tha Sai Amphoe Mueang, Nonthaburi, Th</p>
      <a class="play-btn" href="#">PLAY NOW</a>
    </div>
    <button class="hero-arrow left" aria-label="Previous slide"></button>
    <button class="hero-arrow right" aria-label="Next slide"></button>
  </section>

  <section class="features">
    <div class="feature">
      <div class="icon" aria-hidden="true"><svg width="28" height="28" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><rect x="6" y="3" width="12" height="18" rx="2" stroke="#0db0ff" stroke-width="1.6"/><circle cx="12" cy="17" r="1" fill="#0db0ff"/></svg></div>
      <div class="text"><h3>DOWNLOAD APP</h3><p>Download the app to play lotteries<br>it is fast and simple</p></div>
    </div>
    <div class="feature">
      <div class="icon" aria-hidden="true"><svg width="28" height="28" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><rect x="5" y="10" width="14" height="9" rx="1.2" stroke="#0db0ff" stroke-width="1.6"/><path d="M8 10V8a4 4 0 0 1 8 0v2" stroke="#0db0ff" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/></svg></div>
      <div class="text"><h3>PASSWORD &amp; PIN</h3><p>Keep your password and PIN safe<br>don't share with anyone</p></div>
    </div>
    <div class="feature">
      <div class="icon" aria-hidden="true"><svg width="28" height="28" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="12" r="8" stroke="#0db0ff" stroke-width="1.6"/><path d="M2 12h20M12 2v20" stroke="#0db0ff" stroke-width="1.2" stroke-linecap="round"/></svg></div>
      <div class="text"><h3>WORLD COVERAGE</h3><p>It is used in about 99% of countries<br>best site in the world</p></div>
    </div>
  </section>

  <section class="welcome">
    <h2>WELCOME TO THE OFFICIAL THAI LOTTERY ONLINE PLATFORM</h2>
    <p class="intro-text">
      Thai lottery online has become a popular way for players to participate in the national lottery without buying physical tickets. Our platform offers an easy and convenient way to access the lottery online. Suppose you're wondering how to play the Thai lottery online! Our step-by-step guide will walk you through everything you need to know. We make participating in the online lottery simple, exciting, and enjoyable.
    </p>
    
    <div class="welcome-tabs">
      <button>WHAT IS GLO36?</button>
      <button>PLAY ONLINE</button>
      <button>CREATE ACCOUNT</button>
      <button>LOTTERY GAME</button>
      <button>3UP & DOWN</button>
    </div>

    <div class="glo36-info">
      <strong>GLO36</strong> is the official website and platform for managing all aspects of the government lottery system. Designed to provide a secure and user-friendly experience, it allows you to buy tickets, check results, and manage your account easily. We are committed to offering a reliable, transparent service that ensures the integrity of every lottery draw.
    </div>
  </section>

  <section class="exchange">
    <h2>EXCHANGE DOLLAR</h2>
    <p class="subtitle">Play the lotto using your MasterCard, VISA, Binance, Paypal, Skrill, bank account, or mobile banking.</p>
    
  

    <div class="exchange-cards">
      <div class="exchange-card">
        <div class="label">ALL OVER THE WORLD</div>
        <div class="subtitle-text">SEND MONEY AND GET</div>
        <h3>INSTANT DEPOSIT</h3>
        <button>BUY NOW</button>
      </div>
      <div class="exchange-card">
        <div class="label">ALL OVER THE WORLD</div>
        <div class="subtitle-text">WITHDRAW $ AND GET</div>
        <h3>INSTANT PAYMENT</h3>
        <button>SELL NOW</button>
      </div>
    </div>
  </section>

  <section class="dollar-rate">
    <h2>DOLLAR RATE</h2>
    <p class="subtitle">What is the dollar rate of GLO36 today? Check out the current dollar rate with our dollar-rate calculator.</p>
    
    <div class="rate-calculator">
      <input type="number" id="dollarInput" value="1" min="0" step="0.01">
      <span style="color: #0db0ff; font-weight: 700;">USD</span>
      <span class="equals">=</span>
      <input type="number" id="rateOutput" value="1.5" readonly>
      <select id="currencySelect">
        <option value="1.5">AUS</option>
        <option value="1.3">USD</option>
        <option value="1.7">CAD</option>
        <option value="0.92">EUR</option>
        <option value="1.27">GBP</option>
        <option value="110.5">JPY</option>
        <option value="7.8">CHF</option>
        <option value="1.35">SGD</option>
        <option value="1.55">HKD</option>
        <option value="35.5">INR</option>
        <option value="0.016">THB</option>
        <option value="0.048">PHP</option>
        <option value="0.022">IDR</option>
        <option value="4.20">MYR</option>
        <option value="0.055">VND</option>
        <option value="1.95">NZD</option>
        <option value="0.61">ZAR</option>
        <option value="130">BRL</option>
        <option value="3.67">MXN</option>
        <option value="0.77">CNY</option>
        <option value="8.5">KRW</option>
        <option value="0.031">PKR</option>
        <option value="125">BDT</option>
        <option value="3.75">SAR</option>
      </select>
    </div>
    <p class="rate-note">*Data updated every 15 minutes</p>
  </section>

  <section class="results-section">
    <div class="results-inner">
      <h2>LOTTERY RESULTS</h2>
      <p class="results-sub">Check your lottery results easily, find all the winning numbers, and see if you won the latest lotto jackpots!</p>

      <div class="results-grid">
        <article class="result-card">
          <div class="result-thumb" style="background-image:url('https://i.ibb.co/hJgbHqdf/national.jpg')"></div>
          <div class="result-body">
            <div class="ribbon blue">National</div>
            <h3>THAI NATIONAL LOTTERY</h3>
            <div class="result-meta">01-12-2025 3:45 PM</div>
            <ul class="small-list">
              <li>1st Prize Six Digit <span class="value"> 461252</span></li>
              <li>3Up Straight Rum... <span class="value"> 252</span></li>
              <li>3Up Open Pair <span class="value"> 25</span></li>
            </ul>
            <a class="more-btn" href="#">More Results!</a>
          </div>
        </article>

        <article class="result-card">
          <div class="result-thumb" style="background-image:url('https://i.ibb.co/KxR4Xq5S/pcso.jpg')"></div>
          <div class="result-body">
            <div class="ribbon green">PCSO</div>
            <h3>PHILIPPINE PCSO LOTTERY</h3>
            <div class="result-meta">11-12-2025 2:00 PM</div>
            <ul class="small-list">
              <li>6D Straight Rum... <span class="value">OFF</span></li>
              <li>4D Straight Rum... <span class="value"> 692</span></li>
              <li>2D Straight Rum... <span class="value"> 10-10</span></li>
            </ul>
            <a class="more-btn" href="#">More Results!</a>
          </div>
        </article>

        <article class="result-card">
          <div class="result-thumb" style="background-image:url('https://i.ibb.co/yFMD99JB/bingo.jpg')"></div>
          <div class="result-body">
            <div class="ribbon red">Bingo</div>
            <h3>BANGKOK BINGO LOTTO</h3>
            <div class="result-meta">05-12-2025 10:15 PM</div>
            <ul class="small-list">
              <li>5 Ball Straight R... <span class="value"> 63425</span></li>
              <li>4 Ball Straight R... <span class="value"> 5681</span></li>
              <li>2 Ball Straight <span class="value"> 16</span></li>
            </ul>
            <a class="more-btn" href="#">More Results!</a>
          </div>
        </article>

        <article class="result-card">
          <div class="result-thumb" style="background-image:url('https://i.ibb.co/ccT742gN/toto.jpg')"></div>
          <div class="result-body">
            <div class="ribbon orange">TOTO</div>
            <h3>MALAYSIA TOTO</h3>
            <div class="result-meta">10-12-2025 11:15 PM</div>
            <ul class="small-list">
              <li>3B Straight Rum... <span class="value"> 482</span></li>
              <li>3B Open Pair <span class="value"> 48</span></li>
              <li>2B Straight <span class="value"> 13</span></li>
            </ul>
            <a class="more-btn" href="#">More Results!</a>
          </div>
        </article>
      </div>
    </div>
  </section>

  <section class="winners-section">
    <div class="winners-container">
      <div class="winners-header">LATEST THAI WINNERS</div>
      <div class="winners-list">
        <div class="winner-item">
          <span class="winner-icon"></span>
          <span class="winner-name">ramxxx</span> - 3up single digit
          <span class="winner-amount">($15)</span>
        </div>
        <div class="winner-item">
          <span class="winner-icon"></span>
          <span class="winner-name">shaxxx</span> - 3up game total
          <span class="winner-amount">($90)</span>
        </div>
        <div class="winner-item">
          <span class="winner-icon"></span>
          <span class="winner-name">royxxx</span> - 3up game total
          <span class="winner-amount">($45)</span>
        </div>
        <div class="winner-item">
          <span class="winner-icon"></span>
          <span class="winner-name">ramxxx</span> - Down single digit
          <span class="winner-amount">($20)</span>
        </div>
        <div class="winner-item">
          <span class="winner-icon"></span>
          <span class="winner-name">alexxx</span> - 2up straight
          <span class="winner-amount">($35)</span>
        </div>
        <div class="winner-item">
          <span class="winner-icon"></span>
          <span class="winner-name">joanxxx</span> - 1st prize
          <span class="winner-amount">($150)</span>
        </div>
      </div>
    </div>
  </section>

  <section class="live-results">
    <div class="live-results-grid">
      <div class="live-result-card">
        <div class="result-header">
          <img src="https://i.ibb.co.com/bjV9G9tc/logo.png" alt="Logo" class="result-logo-img">
          <h3>National Lottery Result</h3>
        </div>
        <div class="result-divider"></div>
        <div class="result-date">Draw Date: 01 Dec 2568</div>
        
        <div class="result-numbers">
          <div class="number-group">
            <div class="group-label">1st Prize</div>
            <div class="numbers-row">
              <span class="num">4</span>
              <span class="num">6</span>
              <span class="num">1</span>
              <span class="num">2</span>
              <span class="num">5</span>
              <span class="num">2</span>
            </div>
          </div>

          <div class="number-group">
            <div class="group-label">3Up</div>
            <div class="numbers-row">
              <span class="num">2</span>
              <span class="num">5</span>
              <span class="num">2</span>
            </div>
          </div>

          <div class="number-group">
            <div class="group-label">2Up</div>
            <div class="numbers-row">
              <span class="num">5</span>
              <span class="num">2</span>
            </div>
          </div>

          <div class="number-group">
            <div class="group-label">2Down</div>
            <div class="numbers-row">
              <span class="num">2</span>
              <span class="num">2</span>
            </div>
          </div>
        </div>

        <div class="next-draw">Next Draw Date: 16 Dec 2568</div>
        <div class="next-numbers" data-countdown="2025-12-16 15:45:00">
          <span class="num small countdown-d">5</span>
          <span class="dash">-</span>
          <span class="num small countdown-h">1</span>
          <span class="dash">-</span>
          <span class="num small countdown-m">30</span>
          <span class="dash">-</span>
          <span class="num small countdown-s">0</span>
        </div>
      </div>

      <div class="live-result-card">
        <div class="result-header">
          <img src="https://i.ibb.co.com/bjV9G9tc/logo.png" alt="Logo" class="result-logo-img">
          <h3>Bangkok Lottery Result</h3>
        </div>
        <div class="result-divider"></div>
        <div class="result-date">Draw Date: 05 Dec 2568</div>
        
        <div class="result-numbers">
          <div class="number-group">
            <div class="group-label">3 Ball</div>
            <div class="numbers-row">
              <span class="num">2</span>
              <span class="num">5</span>
              <span class="num">0</span>
              <span class="num">7</span>
              <span class="num">3</span>
              <span class="num">5</span>
            </div>
          </div>

          <div class="number-group">
            <div class="group-label">2 Ball</div>
            <div class="numbers-row">
              <span class="num">7</span>
              <span class="num">3</span>
              <span class="num">5</span>
            </div>
          </div>
        </div>

        <div class="next-draw">Next Draw Date: 16 Dec 2568</div>
        <div class="next-numbers" data-countdown="2025-12-16 15:45:00">
          <span class="num small countdown-d">5</span>
          <span class="dash">-</span>
          <span class="num small countdown-h">1</span>
          <span class="dash">-</span>
          <span class="num small countdown-m">30</span>
          <span class="dash">-</span>
          <span class="num small countdown-s">0</span>
        </div>
      </div>
    </div>
  </section>

  <section class="rates-section">
    <div class="rates-container">
      <h2 class="rates-title">THAI LOTTERY WINNING RATE</h2>
      <div class="rates-table-wrapper">
        <table class="rates-table">
          <thead>
            <tr>
              <th>Sl.No.</th>
              <th>Name</th>
              <th>Rate</th>
              <th>Discount</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>1</td>
              <td>3up direct & rumble</td>
              <td>$1x500</td>
              <td>10</td>
            </tr>
            <tr>
              <td>2</td>
              <td>3up single digit</td>
              <td>$1x3</td>
              <td>0</td>
            </tr>
            <tr>
              <td>3</td>
              <td>3up game total</td>
              <td>$1x9</td>
              <td>0</td>
            </tr>
            <tr>
              <td>4</td>
              <td>2up direct</td>
              <td>$1x70</td>
              <td>5</td>
            </tr>
            <tr>
              <td>5</td>
              <td>Down direct</td>
              <td>$1x80</td>
              <td>5</td>
            </tr>
            <tr>
              <td>6</td>
              <td>Down single digit</td>
              <td>$1x4</td>
              <td>0</td>
            </tr>
            <tr>
              <td>7</td>
              <td>Down game total</td>
              <td>$1x9</td>
              <td>0</td>
            </tr>
            <tr>
              <td>8</td>
              <td>3 Up Rumble</td>
              <td>$1x100</td>
              <td>20</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </section>

  <section class="betting-form-section">
    <div class="betting-form-container">
      <div class="betting-tabs">
        <button class="tab-btn active" data-tab="bet-history">Bet History</button>
        <button class="tab-btn" data-tab="win-history">Win History</button>
        <button class="tab-btn" data-tab="game-rate">Game Rate</button>
        <button class="tab-btn" data-tab="result">Result</button>
      </div>

      <div class="betting-form-wrapper">
        <div class="form-header">
          <h2>THAI LOTTERY</h2>
          <div class="balance-display">USD 0.00 <span class="refresh-icon"></span></div>
        </div>

        <div class="play-type-section">
          <h3>SELECT A PLAY TYPE</h3>
          <div class="play-type-buttons">
            <button class="play-type-btn active" data-type="3up">3UP</button>
            <button class="play-type-btn" data-type="2up">2UP</button>
            <button class="play-type-btn" data-type="down">DOWN</button>
            <button class="play-type-btn" data-type="straight">STRAIGHT</button>
            <button class="play-type-btn" data-type="rumble">RUMBLE</button>
          </div>
        </div>

        <form class="betting-form">
          <div class="form-section">
            <div class="section-title">BET NUMBER</div>
            <div class="bet-rows">
              <div class="bet-row">
                <label>Number</label>
                <input type="text" placeholder="Enter number" class="bet-input">
                <input type="text" placeholder="USD" class="amount-input">
                <input type="text" placeholder="USD" class="amount-input">
              </div>
              <div class="bet-row">
                <label>Number</label>
                <input type="text" placeholder="Enter number" class="bet-input">
                <input type="text" placeholder="USD" class="amount-input">
                <input type="text" placeholder="USD" class="amount-input">
              </div>
              <div class="bet-row">
                <label>Number</label>
                <input type="text" placeholder="Enter number" class="bet-input">
                <input type="text" placeholder="USD" class="amount-input">
                <input type="text" placeholder="USD" class="amount-input">
              </div>
              <div class="bet-row">
                <label>Number</label>
                <input type="text" placeholder="Enter number" class="bet-input">
                <input type="text" placeholder="USD" class="amount-input">
                <input type="text" placeholder="USD" class="amount-input">
              </div>
              <div class="bet-row">
                <label>Number</label>
                <input type="text" placeholder="Enter number" class="bet-input">
                <input type="text" placeholder="USD" class="amount-input">
                <input type="text" placeholder="USD" class="amount-input">
              </div>
              <div class="bet-row">
                <label>Number</label>
                <input type="text" placeholder="Enter number" class="bet-input">
                <input type="text" placeholder="USD" class="amount-input">
                <input type="text" placeholder="USD" class="amount-input">
              </div>
              <div class="bet-row">
                <label>Number</label>
                <input type="text" placeholder="Enter number" class="bet-input">
                <input type="text" placeholder="USD" class="amount-input">
                <input type="text" placeholder="USD" class="amount-input">
              </div>
              <div class="bet-row">
                <label>Number</label>
                <input type="text" placeholder="Enter number" class="bet-input">
                <input type="text" placeholder="USD" class="amount-input">
                <input type="text" placeholder="USD" class="amount-input">
              </div>
            </div>
          </div>

          <div class="form-totals">
            <div class="total-item">
              <span>BET TOTAL</span>
              <span class="total-value">0</span>
            </div>
            <div class="total-item">
              <span>DISCOUNT</span>
              <span class="total-value">0</span>
            </div>
            <div class="total-item">
              <span>AFTER DISCOUNT</span>
              <span class="total-value">0</span>
            </div>
          </div>

          <button type="submit" class="submit-btn" id="submitBetBtn">SUBMIT</button>
        </form>
      </div>
    </div>
  </section>

  <!-- My Receipts Section (Customer View Only) -->
  <section id="myReceiptsSection" class="betting-form-section" style="display:none;margin-top:40px;">
    <div class="betting-form-container">
      <div style="margin-bottom:30px;">
        <h2 style="font-size:28px;color:#0db0ff;margin-bottom:10px;"> MY PAYMENT RECEIPTS</h2>
        <div style="font-size:14px;color:#999;">Welcome back, <span id="customerNameDisplay" style="color:#f2c94c;font-weight:700;">User</span>! Here are all your payment records.</div>
      </div>

      <div id="customerReceiptsList" style="display:grid;gap:16px;">
        <div class="empty-state" style="text-align:center;padding:40px;color:#999;">
          <div style="font-size:48px;margin-bottom:10px;"></div>
          <div style="font-size:16px;">No receipts yet</div>
          <div style="font-size:12px;margin-top:10px;color:#666;">Make your first payment to see it here</div>
        </div>
      </div>
    </div>
  </section>

  <!-- Registration Warning Modal -->
  <div id="registrationWarningModal" class="modal hidden">
    <div class="modal-content" style="background:linear-gradient(135deg,#ff6b6b,#ff8e53);max-width:500px;">
      <div class="modal-header" style="background:rgba(0,0,0,0.2);border-bottom:2px solid rgba(255,255,255,0.3);">
        <h2 style="color:#fff;font-size:24px;"> REGISTRATION</h2>
        <button class="modal-close" style="color:#fff;font-size:28px;">&times;</button>
      </div>
      <div style="padding:30px;text-align:center;color:#fff;">
        <div style="font-size:48px;margin-bottom:20px;"></div>
        <div style="font-size:18px;font-weight:700;margin-bottom:20px;line-height:1.6;">
          DEAR SIR<br>PLEASE CONTACT OUR HEAD OFFICE OR AN AGENT TO OPEN AN ACCOUNT
        </div>
        <div style="font-size:14px;opacity:0.9;margin-bottom:30px;">
          We're here to help you get started. Reach out to us today!
        </div>
        <button class="registration-close-btn" style="background:#fff;color:#ff6b6b;padding:12px 30px;border:none;border-radius:6px;font-weight:700;cursor:pointer;font-size:16px;transition:all 0.3s ease;">
          CLOSE
        </button>
      </div>
    </div>
  </div>

  <!-- Login Modal -->
  <div id="loginModal" class="modal hidden">
    <div class="modal-content login-content">
      <div class="modal-header login-header">
        <h2> LOGIN</h2>
        <button class="modal-close">&times;</button>
      </div>
      
      <div class="login-body">
        <div style="text-align:center;margin-bottom:20px;">
          <img src="https://i.ibb.co.com/bjV9G9tc/logo.png" alt="Logo" style="height:60px;width:auto;">
        </div>
        <div class="login-title">NATIONAL THAI LOTTERY</div>
        <div class="login-divider"></div>
        
        <div class="login-form">
          <div class="form-group">
            <label for="userIdInput">User ID</label>
            <input type="text" id="userIdInput" placeholder="Enter your User ID" class="login-input">
          </div>
          
          <div class="form-group">
            <label for="userNameInput">Your Name (Optional)</label>
            <input type="text" id="userNameInput" placeholder="Enter your name" class="login-input" style="font-size:14px;">
          </div>
          
          <button id="loginSubmitBtn" class="login-btn">LOGIN</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Payment Modal -->
  <div id="paymentModal" class="modal hidden">
    <div class="modal-content">
      <div class="modal-header">
        <h2>PAYMENT METHOD</h2>
        <button class="modal-close">&times;</button>
      </div>
      
      <div class="payment-summary">
        <div class="summary-row">
          <span>Bet Details:</span>
          <span id="summaryDetails">-</span>
        </div>
        <div class="summary-row">
          <span>Total Amount:</span>
          <span id="summaryTotal">$0.00</span>
        </div>
        <div class="summary-row">
          <span>Discount:</span>
          <span id="summaryDiscount">$0.00</span>
        </div>
        <div class="summary-row final">
          <span>Final Amount:</span>
          <span id="summaryFinal">$0.00</span>
        </div>
      </div>

      <div class="payment-methods-grid">
        <button class="payment-method-btn" data-method="binance">
          <img src="https://i.ibb.co/356Vbn3B/download-3.png" alt="Binance">
          <span>Binance Pay</span>
        </button>
        <button class="payment-method-btn" data-method="amex">
          <img src="https://i.ibb.co/Kpvjb1w4/download-4.png" alt="American Express">
          <span>American Express</span>
        </button>
        <button class="payment-method-btn" data-method="mastercard">
          <img src="https://i.ibb.co/cc1bKkTp/download-5.png" alt="Mastercard">
          <span>Mastercard</span>
        </button>
        <button class="payment-method-btn" data-method="paypal">
          <img src="https://upload.wikimedia.org/wikipedia/commons/b/b5/PayPal.svg" alt="PayPal">
          <span>PayPal</span>
        </button>
        <button class="payment-method-btn" data-method="bkash">
          <img src="https://i.ibb.co/TDTRGZMH/download-2.png" alt="bKash">
          <span>bKash</span>
        </button>
        <button class="payment-method-btn" data-method="googlepay">
          <img src="https://i.ibb.co/JJDpCtQ/download-1.png" alt="Google Pay">
          <span>Google Pay</span>
        </button>
        <button class="payment-method-btn" data-method="paytm">
          <img src="https://i.ibb.co/8DY7QRfB/download.png" alt="Paytm">
          <span>Paytm</span>
        </button>
        <button class="payment-method-btn" data-method="phonepay">
          <img src="https://i.ibb.co/9c3rqGvC/phonepay.png" alt="PhonePe">
          <span>Phone Pay</span>
        </button>
      </div>

      <div class="payment-instruction">
        <p>Click on your preferred payment method to continue with payment</p>
      </div>
    </div>
  </div>

  <!-- Receipt Modal -->
  <!-- Receipt History Modal -->
  <div id="receiptHistoryModal" class="receipt-history-modal modal hidden">
    <div class="modal-content receipt-history-content">
      <div class="modal-header receipt-header">
        <h2>RECEIPT HISTORY</h2>
        <button class="modal-close" id="receiptHistoryClose">&times;</button>
      </div>
      <div class="receipt-list" id="receiptList">
        <div class="empty-receipts">
          <div class="empty-receipts-icon"></div>
          <div>No receipts yet</div>
        </div>
      </div>
    </div>
  </div>

  <div id="receiptModal" class="modal hidden">
    <div class="modal-content receipt-content">
      <div class="modal-header receipt-header">
        <h2>PAYMENT RECEIPT</h2>
        <button class="modal-close">&times;</button>
      </div>
      
      <div class="receipt-body">
        <div class="receipt-title">GLO36 LOTTERY</div>
        <div class="receipt-divider"></div>
        
        <div class="receipt-section">
          <div class="receipt-label">Receipt Number</div>
          <div class="receipt-value receipt-number" id="receiptNumber">RCP-001</div>
        </div>

        <div class="receipt-section">
          <div class="receipt-label">Date & Time</div>
          <div class="receipt-value" id="receiptDateTime">-</div>
        </div>

        <div class="receipt-section">
          <div class="receipt-label">Play Type</div>
          <div class="receipt-value" id="receiptPlayType">3UP</div>
        </div>

        <div class="receipt-section">
          <div class="receipt-label">Number of Bets</div>
          <div class="receipt-value" id="receiptBetCount">1</div>
        </div>

        <div class="receipt-divider"></div>

        <div class="receipt-section">
          <div class="receipt-label">Numbers & Amounts</div>
          <div class="receipt-numbers-wrap">
            <div id="receiptNumbersList" style="margin-top:8px;">
              <!-- Numbers will be populated here -->
            </div>
          </div>
        </div>

        <div class="receipt-divider"></div>
          <div class="receipt-label">Total Amount</div>
          <div class="receipt-value" id="receiptTotalAmount">$0.00</div>
        </div>

        <div class="receipt-section">
          <div class="receipt-label">Discount (5%)</div>
          <div class="receipt-value" id="receiptDiscountAmount">$0.00</div>
        </div>

        <div class="receipt-section final-amount">
          <div class="receipt-label">Final Amount Paid</div>
          <div class="receipt-value receipt-amount" id="receiptFinalAmount">$0.00</div>
        </div>

        <div class="receipt-divider"></div>

        <div class="receipt-section">
          <div class="receipt-label">Payment Method</div>
          <div class="receipt-value" id="receiptPaymentMethod">-</div>
        </div>

        <div class="receipt-section">
          <div class="receipt-label">Status</div>
          <div class="receipt-value receipt-status" id="receiptStatus"> PENDING APPROVAL</div>
        </div>

        <div class="receipt-section" id="approvalNotice" style="background:rgba(255,193,7,0.1);padding:12px;border-radius:6px;border-left:3px solid #ffc107;">
          <div style="font-size:12px;color:#ffc107;font-weight:700;margin-bottom:6px;"> Awaiting Admin Approval</div>
          <div style="font-size:11px;color:#9aa0a6;line-height:1.5;">
            Your payment has been received. Your account will be credited once the admin verifies and approves this transaction. You will receive a confirmation email.
          </div>
        </div>

        <div class="receipt-divider"></div>

        <div class="receipt-section">
          <div class="receipt-label">Transaction ID</div>
          <div class="receipt-value" id="receiptTransactionId" style="font-size:11px;word-break:break-all;">-</div>
        </div>

        <div class="receipt-security-box">
          <div style="font-size:12px;color:#4caf50;font-weight:700;margin-bottom:8px;"> SECURE & VERIFIED</div>
          <ul style="font-size:11px;color:#9aa0a6;margin:0;padding-left:16px;line-height:1.6;">
            <li>SSL Encrypted Connection</li>
            <li>PCI DSS Compliant</li>
            <li>Payment Verified</li>
            <li>Account Updated</li>
          </ul>
        </div>

        <div class="receipt-divider"></div>

        <div class="receipt-footer">
          <p>Thank you for your payment!</p>
          <p style="font-size: 11px; color: #9aa0a6;">Your bet will be processed immediately</p>
        </div>
        <div style="display:flex;gap:10px;margin-top:12px;">
          <button class="receipt-print-btn" id="downloadReceiptBtn"> DOWNLOAD</button>
          <button class="receipt-print-btn" id="printReceiptBtn"> PRINT RECEIPT</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Admin Approval Panel -->
  <div id="adminPanel" class="admin-panel hidden">
    <div class="admin-panel-content">
      <div class="admin-header">
        <h2>PAYMENT APPROVAL PANEL</h2>
        <div style="display:flex;gap:10px;">
          <button id="viewApprovalBtn" class="tab-button active" style="padding:8px 16px;border:none;background:#0db0ff;color:#fff;border-radius:4px;cursor:pointer;font-weight:600;">View Approvals</button>
          <button id="viewAllUsersBtn" class="tab-button" style="padding:8px 16px;border:none;background:rgba(255,255,255,0.1);color:#fff;border-radius:4px;cursor:pointer;font-weight:600;"> All Users Data</button>
        </div>
        <button class="admin-close" id="adminClose">&times;</button>
      </div>

      <div class="admin-body">
        <div id="approvalView" style="display:block;">
          <div class="pending-payments-section">
            <h3>Pending Approvals</h3>
            <div id="pendingPaymentsList" class="pending-list">
              <div class="empty-state">No pending payments</div>
            </div>
          </div>

          <div class="approved-payments-section">
            <h3>Approved Payments</h3>
            <div id="approvedPaymentsList" class="approved-list">
              <div class="empty-state">No approved payments</div>
            </div>
          </div>
        </div>

        <div id="allUsersView" style="display:none;max-height:600px;overflow-y:auto;">
          <div style="margin-bottom:20px;">
            <input type="text" id="userSearchInput" placeholder=" Search by Name or User ID..." style="width:100%;padding:12px;background:#1a1a1a;border:1px solid #333;color:#fff;border-radius:4px;font-size:14px;">
            <div style="font-size:11px;color:#999;margin-top:6px;"> Search by customer name or User ID</div>
          </div>
          <div id="allUsersList" style="display:grid;gap:12px;">
            <div class="empty-state">Loading users...</div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Floating Admin Button -->
  <div id="adminToggleBtn" class="admin-toggle-btn" title="Admin Panel"></div>

  <div class="footer-container">
      <div class="visitor-counter">
        <div class="counter-number">189891</div>
        <div class="counter-text">TODAY TOTAL GLO36 WEBSITE VISITORS!</div>
      </div>

      <div class="payment-methods">
        <div class="payment-label">SUPPORTED GLO36 PAYMENT METHODS</div>
        <div class="payment-icons">
          <div class="pay-card"><img src="https://i.ibb.co/356Vbn3B/download-3.png" alt="Binance"></div>
          <div class="pay-card"><img src="https://i.ibb.co/Kpvjb1w4/download-4.png" alt="American Express"></div>
          <div class="pay-card"><img src="https://i.ibb.co/cc1bKkTp/download-5.png" alt="Mastercard"></div>
          <div class="pay-card"><img src="https://upload.wikimedia.org/wikipedia/commons/b/b5/PayPal.svg" alt="PayPal"></div>
          <div class="pay-card"><img src="https://i.ibb.co/TDTRGZMH/download-2.png" alt="bKash"></div>
          <div class="pay-card"><img src="https://i.ibb.co/JJDpCtQ/download-1.png" alt="Google Pay"></div>
          <div class="pay-card"><img src="https://i.ibb.co/8DY7QRfB/download.png" alt="Paytm"></div>
        </div>
      </div>

      <div class="footer-nav">
        <a href="#">Home</a> | 
        <a href="#">Contact</a> | 
        <a href="#">Download Glo36 App</a> | 
        <a href="#">Notice</a> | 
        <a href="#">About</a>
      </div>

      <div class="footer-columns">
        <div class="footer-col">
          <a href="#">Play Thai Lottery</a>
          <a href="#">Play PGo Lottery</a>
          <a href="#">Play Bingo Lottery</a>
          <a href="#">Play Toto Lottery</a>
        </div>
        <div class="footer-col">
          <a href="#">Thai Lottery Result</a>
          <a href="#">PGo Lottery Result</a>
          <a href="#">Bingo Lottery Result</a>
          <a href="#">Toto Lottery Result</a>
        </div>
        <div class="footer-col">
          <a href="#">Thai Lottery Prize</a>
          <a href="#">PGo Lottery Prize</a>
          <a href="#">Bingo Lottery Prize</a>
          <a href="#">Toto Lottery Prize</a>
        </div>
      </div>

      <div class="footer-links">
        <a href="#">How to Play</a> | 
        <a href="#">Responsible Play at Glo36</a> | 
        <a href="#">Security & Fair Play</a> | 
        <a href="#">Automatic Credit for Winners</a> | 
        <a href="#">News</a> | 
        <a href="#">FAQ</a>
      </div>

      <div class="footer-bottom">
        <div class="footer-legal">
          <a href="#">Terms and Condition</a> | 
          <a href="#">Privacy and Policy</a>
        </div>
        <div class="footer-copyright">
          Copyright  2025 glo36.com.co All Rights Reserved.
        </div>
      </div>
    </div>
  </footer>

  <script>
    // Wait for Firebase to be ready
    let firebaseReady = false;
    let database = null;
    
    // Check if Firebase is loaded
    function waitForFirebase(callback, maxAttempts = 50) {
      let attempts = 0;
      const checkInterval = setInterval(() => {
        if (typeof firebase !== 'undefined' && firebase.initializeApp) {
          clearInterval(checkInterval);
          firebaseReady = true;
          if (callback) callback();
        } else if (attempts++ > maxAttempts) {
          clearInterval(checkInterval);
          console.warn('Firebase failed to load after waiting. Using localStorage fallback.');
          firebaseReady = false;
          if (callback) callback();
        }
      }, 100);
    }

    // Initialize Firebase when ready
    waitForFirebase(() => {
      if (firebaseReady && typeof firebase !== 'undefined') {
        const firebaseConfig = {
          apiKey: "AIzaSyCkH7_4Ezb_2NAI-4vidvI6mDoZd9BRPx4",
          authDomain: "erkom-lottery.firebaseapp.com",
          databaseURL: "https://erkom-lottery-default-rtdb.asia-southeast1.firebasedatabase.app",
          projectId: "erkom-lottery",
          storageBucket: "erkom-lottery.firebasestorage.app",
          messagingSenderId: "202539006738",
          appId: "1:202539006738:web:2fa131bc3c1540690f91cb"
        };

        try {
          if (!firebase.apps.length) {
            firebase.initializeApp(firebaseConfig);
          }
          database = firebase.database();
          console.log(' Firebase initialized successfully');
        } catch (error) {
          console.error('Firebase initialization error:', error);
          firebaseReady = false;
          database = null;
        }
      } else {
        console.warn('Firebase SDK not available. Using localStorage fallback.');
        firebaseReady = false;
      }
    });

    // Slider functionality
    (function(){
      const slides = Array.from(document.querySelectorAll('.hero-slides .slide'));
      const prevBtn = document.querySelector('.hero-arrow.left');
      const nextBtn = document.querySelector('.hero-arrow.right');
      let idx = 0;
      let interval = null;
      const delay = 5000; // 5s

      function show(index) {
        slides.forEach((s, i) => s.classList.toggle('active', i === index));
        idx = index;
        // update hero text from active slide's data attributes
        const slide = slides[index];
        const titleEl = document.querySelector('.hero-content h1');
        const subEl = document.querySelector('.hero-content .subtitle');
        if (slide && titleEl && subEl) {
          if (slide.dataset.title) titleEl.textContent = slide.dataset.title;
          if (slide.dataset.subtitle) subEl.textContent = slide.dataset.subtitle;
        }
      }

      function next() { show((idx + 1) % slides.length); }
      function prev() { show((idx - 1 + slides.length) % slides.length); }

      nextBtn.addEventListener('click', () => { stop(); next(); start(); });
      prevBtn.addEventListener('click', () => { stop(); prev(); start(); });

      function start() { interval = setInterval(next, delay); }
      function stop() { if (interval) { clearInterval(interval); interval = null; } }

      // pause on hover
      const hero = document.getElementById('hero');
      hero.addEventListener('mouseenter', stop);
      hero.addEventListener('mouseleave', () => { start(); });

      // initialize text to current slide and start
      show(idx);
      start();
    })();

    // Currency converter
    (function(){
      const dollarInput = document.getElementById('dollarInput');
      const currencySelect = document.getElementById('currencySelect');
      const rateOutput = document.getElementById('rateOutput');
      
      function updateRate() {
        const dollars = parseFloat(dollarInput.value) || 0;
        const rate = parseFloat(currencySelect.value) || 1.5;
        rateOutput.value = (dollars * rate).toFixed(2);
      }
      
      dollarInput.addEventListener('input', updateRate);
      currencySelect.addEventListener('change', updateRate);
    })();

    // Live Countdown Timer
    (function(){
      function updateCountdowns() {
        const countdownElements = document.querySelectorAll('.next-numbers[data-countdown]');
        
        countdownElements.forEach(el => {
          const targetTime = new Date(el.dataset.countdown).getTime();
          const now = new Date().getTime();
          const distance = targetTime - now;
          
          if (distance > 0) {
            const days = Math.floor(distance / (1000 * 60 * 60 * 24));
            const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
            const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
            const seconds = Math.floor((distance % (1000 * 60)) / 1000);
            
            const dayEl = el.querySelector('.countdown-d');
            const hourEl = el.querySelector('.countdown-h');
            const minEl = el.querySelector('.countdown-m');
            const secEl = el.querySelector('.countdown-s');
            
            if (dayEl) dayEl.textContent = days;
            if (hourEl) hourEl.textContent = hours;
            if (minEl) minEl.textContent = minutes;
            if (secEl) secEl.textContent = seconds;
          } else {
            const dayEl = el.querySelector('.countdown-d');
            const hourEl = el.querySelector('.countdown-h');
            const minEl = el.querySelector('.countdown-m');
            const secEl = el.querySelector('.countdown-s');
            
            if (dayEl) dayEl.textContent = 0;
            if (hourEl) hourEl.textContent = 0;
            if (minEl) minEl.textContent = 0;
            if (secEl) secEl.textContent = 0;
          }
        });
      }
      
      updateCountdowns();
      setInterval(updateCountdowns, 1000);
    })();

    // Auto-scrolling Winners
    (function(){
      const winnersList = document.querySelector('.winners-list');
      if (!winnersList) return;
      
      const winners = Array.from(winnersList.querySelectorAll('.winner-item'));
      let currentIndex = 0;
      
      function rotateWinners() {
        if (winners.length <= 1) return;
        
        // Fade out current
        winners[currentIndex].style.opacity = '0';
        winners[currentIndex].style.transform = 'translateY(-10px)';
        
        // Move to next
        currentIndex = (currentIndex + 1) % winners.length;
        
        // Fade in next after a brief delay
        setTimeout(() => {
          winners.forEach((w, i) => {
            if (i === currentIndex) {
              w.style.opacity = '1';
              w.style.transform = 'translateY(0)';
            } else {
              w.style.opacity = '0';
              w.style.transform = 'translateY(-10px)';
              w.style.display = 'none';
            }
          });
          winners[currentIndex].style.display = 'flex';
        }, 300);
      }
      
      // Show first winner
      winners.forEach((w, i) => {
        if (i === 0) {
          w.style.opacity = '1';
          w.style.transform = 'translateY(0)';
        } else {
          w.style.opacity = '0';
          w.style.transform = 'translateY(-10px)';
          w.style.display = 'none';
        }
        w.style.transition = 'all 0.3s ease-in-out';
      });
      
      // Rotate every 3 seconds
      setInterval(rotateWinners, 3000);
    })();

    // Ensure all functions are ready
    window.addEventListener('load', function() {
      console.log(' Page fully loaded');
      console.log(' Firebase:', typeof firebase !== 'undefined' ? 'Ready' : 'Not loaded');
      console.log(' Functions available:', {
        loginBtn: !!document.getElementById('loginBtn'),
        betForm: !!document.querySelector('.betting-form'),
        adminBtn: !!document.getElementById('adminToggleBtn'),
        modals: {
          login: !!document.getElementById('loginModal'),
          payment: !!document.getElementById('paymentModal'),
          receipt: !!document.getElementById('receiptModal'),
          admin: !!document.getElementById('adminPanel')
        }
      });
    });

    // LOGIN FUNCTIONALITY
    (function initLogin() {
      // Function to get database reference (safe check)
      function getDB() {
        if (firebaseReady && database) {
          return database;
        }
        return null;
      }

      // Function to load payments from Firebase
      function loadPaymentsFromFirebase(callback) {
        const db = getDB();
        if (!db) {
          // Fallback to localStorage
          const saved = localStorage.getItem('paymentData');
          if (saved) {
            try {
              const data = JSON.parse(saved);
              callback(data.pending || [], data.approved || []);
            } catch (e) {
              console.warn('Failed to parse saved payment data:', e);
              callback([], []);
            }
          } else {
            callback([], []);
          }
          return;
        }

        // When DB is available, read both the legacy 'payments' root and per-user payments
        try {
          Promise.all([
            db.ref('payments').once('value'),
            db.ref('users').once('value')
          ]).then(results => {
            const paymentsSnap = results[0];
            const usersSnap = results[1];

            let pending = [];
            let approved = [];

            // root payments (legacy)
            try {
              const root = paymentsSnap.val() || { pending: [], approved: [] };
              pending = pending.concat(root.pending || []);
              approved = approved.concat(root.approved || []);
            } catch (e) { console.warn('Error reading root payments', e); }

            // aggregate per-user payments under users/*/payments
            try {
              const users = usersSnap.val() || {};
              Object.keys(users).forEach(uid => {
                const up = users[uid] && users[uid].payments;
                if (!up) return;
                // payments may be keyed by id
                if (Array.isArray(up)) {
                  up.forEach(p => { if (!p) return; (p.status === 'approved' ? approved : pending).push(p); });
                } else {
                  Object.keys(up).forEach(k => {
                    const p = up[k];
                    if (!p) return;
                    (p.status === 'approved' ? approved : pending).push(p);
                  });
                }
              });
            } catch (e) { console.warn('Error aggregating user payments', e); }

            callback(pending, approved);
          }).catch(err => {
            console.warn('Firebase read error, using localStorage fallback:', err);
            const saved = localStorage.getItem('paymentData');
            if (saved) {
              try {
                const data = JSON.parse(saved);
                callback(data.pending || [], data.approved || []);
              } catch (e) {
                callback([], []);
              }
            } else {
              callback([], []);
            }
          });
        } catch (error) {
          console.warn('Firebase error, falling back to localStorage:', error);
          callback([], []);
        }
      }

      // Function to save payments to Firebase
      function savePaymentsToFirebase(pending, approved) {
        const db = getDB();
        
        // Always save to localStorage as backup
        try {
          localStorage.setItem('paymentData', JSON.stringify({
            pending: pending,
            approved: approved,
            lastUpdated: new Date().toISOString()
          }));
        } catch (e) {
          console.warn('Failed to save to localStorage:', e);
        }

        // Try to save to Firebase if available
        if (!db) return;

        try {
          db.ref('payments').set({
            pending: pending,
            approved: approved,
            lastUpdated: new Date().toISOString()
          }).catch(err => {
            console.warn('Firebase write error:', err);
          });
        } catch (error) {
          console.warn('Firebase error:', error);
        }
      }

      // Make functions global
      window.loadPaymentsFromFirebase = loadPaymentsFromFirebase;
      window.savePaymentsToFirebase = savePaymentsToFirebase;

      // Notification helper
      function showNotification(message, type = 'info', opts = {}) {
        try {
          let container = document.querySelector('.site-notification');
          if (!container) {
            container = document.createElement('div');
            container.className = 'site-notification';
            document.body.appendChild(container);
          }

          const note = document.createElement('div');
          note.className = 'note show ' + (opts.small ? 'small ' : '') + (type === 'success' ? ' success' : (type === 'warn' ? ' warn' : ' info'));

          const icon = document.createElement('div');
          icon.className = 'icon';
          icon.innerHTML = type === 'success' ? '' : (type === 'warn' ? '' : '');

          const text = document.createElement('div');
          text.className = 'text';
          text.innerHTML = message;

          note.appendChild(icon);
          note.appendChild(text);

          if (opts.action) {
            const btn = document.createElement('button');
            btn.textContent = opts.action.label || 'OK';
            btn.style.cssText = 'margin-left:12px;padding:8px 12px;border-radius:8px;border:none;cursor:pointer;background:rgba(255,255,255,0.12);color:#fff;font-weight:700;';
            btn.onclick = function(e){ e.stopPropagation(); if (opts.action.cb) opts.action.cb(); note.classList.add('hide'); setTimeout(()=>note.remove(),350); };
            note.appendChild(btn);
          }

          container.appendChild(note);

          // Auto remove
          const timeout = opts.timeout === 0 ? null : (opts.timeout || 4000);
          if (timeout) setTimeout(() => { note.classList.add('hide'); setTimeout(()=>note.remove(),350); }, timeout);

          return note;
        } catch (e) { console.warn('notify error', e); }
      }

      window.showNotification = showNotification;

      // ===== GLOBAL LOGOUT FUNCTION =====
      window.doLogout = function(e) {
        if (e && e.preventDefault) { e.preventDefault(); e.stopPropagation(); }
        console.log(' LOGOUT TRIGGERED');
        
        // Clear all storage
        try { localStorage.clear(); } catch (er) { console.warn('localStorage clear:', er); }
        try { sessionStorage.clear(); } catch (er) { console.warn('sessionStorage clear:', er); }
        
        // Show logout message
        try {
          const note = document.createElement('div');
          note.style.cssText = 'position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);background:linear-gradient(135deg,#10b981,#059669);color:#fff;padding:40px;border-radius:12px;z-index:9999;text-align:center;';
          note.innerHTML = '<div style="font-size:18px;font-weight:700;"> Logged out successfully!</div>';
          document.body.appendChild(note);
          setTimeout(() => { try { note.remove(); } catch (e) {} }, 400);
        } catch (er) {}
        
        // Reload page after a brief delay
        setTimeout(() => {
          try { location.href = location.pathname; } catch (er) {
            try { location.reload(true); } catch (e2) { window.location.reload(); }
          }
        }, 300);
      };

      // ALL BUTTON INITIALIZATION - Wait for DOM to be ready
      document.addEventListener('DOMContentLoaded', function() {
        const loginBtn = document.getElementById('loginBtn');
        const loginModal = document.getElementById('loginModal');
        const loginSubmitBtn = document.getElementById('loginSubmitBtn');
        const userIdInput = document.getElementById('userIdInput');

        if (loginBtn && loginModal) {
          // Open login modal
          loginBtn.addEventListener('click', (e) => {
            e.preventDefault();
            e.stopPropagation();
            loginModal.classList.remove('hidden');
            if (userIdInput) userIdInput.focus();
        });

        // Close login modal
        const loginClose = loginModal.querySelector('.modal-close');
        if (loginClose) {
          loginClose.onclick = (e) => {
            e.preventDefault();
            loginModal.classList.add('hidden');
          };
        }

        loginModal.addEventListener('click', (e) => {
          if (e.target === loginModal) {
            e.preventDefault();
            loginModal.classList.add('hidden');
          }
        });

        // Handle login submission
        if (loginSubmitBtn) {
          loginSubmitBtn.addEventListener('click', () => {
            const userId = userIdInput.value.trim();
            const userName = document.getElementById('userNameInput')?.value.trim() || 'User ' + userId;

            if (!userId) {
              showNotification('Please enter your User ID','warn',{timeout:3000});
              userIdInput.focus();
              return;
            }

            // Check if User ID is "000000"
          if (userId !== '000000') {
            showNotification('Invalid User ID. Please try again.','warn',{timeout:3000});
            userIdInput.focus();
            return;
          }

          // Successful login - show beautiful notification
          const loginNotification = document.createElement('div');
          loginNotification.style.cssText = 'position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);background:linear-gradient(135deg,#10b981,#059669);color:#fff;padding:50px 40px;border-radius:15px;font-weight:700;z-index:3000;box-shadow:0 20px 60px rgba(16,185,129,0.4);animation:popIn 0.5s ease;max-width:450px;text-align:center;';
          loginNotification.innerHTML = `
            <div style="font-size:60px;margin-bottom:20px;"></div>
            <div style="font-size:28px;margin-bottom:15px;">Login Successful!</div>
            <div style="font-size:16px;opacity:0.95;margin-bottom:25px;line-height:1.6;">Welcome back, ${userName}!</div>
            <div style="font-size:14px;opacity:0.85;">Redirecting in 2 seconds...</div>
          `;
          document.body.appendChild(loginNotification);
          
          localStorage.setItem('userLoggedIn', 'true');
          localStorage.setItem('userId', userId);
          localStorage.setItem('userName', userName);
          sessionStorage.setItem('userSession', 'active');
          
          // Save name to Firebase
          if (typeof firebase !== 'undefined' && firebase.database) {
            try {
              firebase.database().ref(`users/${userId}/profile/name`).set(userName).catch(err => {
                console.warn('Error saving name to Firebase:', err);
              });
            } catch (e) {
              console.warn('Firebase error:', e);
            }
          }
          
          // Reset form and close modal
          userIdInput.value = '';
          document.getElementById('userNameInput').value = '';
          loginModal.classList.add('hidden');

          // Hide login/register buttons after successful login
          const updateButtons = () => {
            const isLoggedIn = localStorage.getItem('userLoggedIn') === 'true';
            const loginBtn = document.getElementById('loginBtn');
            const registerBtn = document.getElementById('registerBtn');
            const logoutBtn = document.getElementById('logoutBtn');
            if (loginBtn && registerBtn && logoutBtn) {
              if (isLoggedIn) {
                loginBtn.style.display = 'none';
                registerBtn.style.display = 'none';
                logoutBtn.style.display = 'block';
              }
            }
          };
          updateButtons();
          
          // Auto remove notification after 2 seconds
          setTimeout(() => {
            if (loginNotification.parentElement) {
              loginNotification.remove();
            }
          }, 2000);

          // Show a logged-in notification
          const notification = document.createElement('div');
          notification.style.cssText = 'position:fixed;top:20px;right:20px;background:linear-gradient(135deg,#0db0ff,#1db7ff);color:#fff;padding:20px 24px;border-radius:8px;font-weight:700;z-index:2000;box-shadow:0 8px 24px rgba(13,176,255,0.4);animation:slideLeft 0.5s ease;';
          notification.innerHTML = `<div> Welcome back, User ${userId}!</div>`;
          document.body.appendChild(notification);
          setTimeout(() => notification.remove(), 3000);

          // Sync local receipts to Firebase for this user (keep local copy)
          (async function syncReceiptsToFirebase(){
            if (!firebaseReady || !database) return;
            try {
              const saved = localStorage.getItem('paymentData');
              if (!saved) return;
              const payments = JSON.parse(saved) || { approved: [], pending: [] };
              const allPayments = [...(payments.approved || []), ...(payments.pending || [])];
              if (!allPayments.length) return;

              allPayments.forEach(p => {
                try {
                  // ensure id
                  if (!p.id) p.id = 'loc-' + Date.now().toString(36) + '-' + Math.random().toString(36).slice(2,6);
                  // Write each payment under users/{userId}/payments/{id}
                  database.ref(`users/${userId}/payments/${p.id}`).set(p).catch(err => console.warn('Firebase write error', err));
                } catch (e) { console.warn('Payment write error', e); }
              });

              // update lastSynced timestamp
              database.ref(`users/${userId}/lastSynced`).set(new Date().toISOString()).catch(err => console.warn('Failed to set lastSynced', err));
              showNotification('Receipts synced to server','success',{timeout:2200});
            } catch (err) {
              console.warn('Sync receipts failed', err);
              showNotification('Sync failed. Receipts saved locally.','warn',{timeout:3000});
            }
          })();

          // After successful login, automatically open Receipt History so user can view receipts
          setTimeout(() => {
            try {
              const receiptBtn = document.getElementById('receiptHistoryBtn');
              if (receiptBtn) receiptBtn.click();
            } catch (e) { console.warn('Failed to open receipt history automatically', e); }
          }, 700);
        });
        }

        // Allow Enter key to submit
        if (loginSubmitBtn && userIdInput) {
          userIdInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') loginSubmitBtn.click();
          });
        }

        // Register button handler
        const registerBtn = document.getElementById('registerBtn');
        const registrationWarningModal = document.getElementById('registrationWarningModal');
        if (registerBtn && registrationWarningModal) {
          registerBtn.addEventListener('click', () => {
            registrationWarningModal.classList.remove('hidden');
          });

          // Close registration warning modal
          const regCloseBtn = registrationWarningModal.querySelector('.registration-close-btn');
          const regModalClose = registrationWarningModal.querySelector('.modal-close');
          if (regCloseBtn) {
            regCloseBtn.addEventListener('click', () => {
              registrationWarningModal.classList.add('hidden');
            });
          }
          if (regModalClose) {
            regModalClose.addEventListener('click', () => {
              registrationWarningModal.classList.add('hidden');
            });
          }
          registrationWarningModal.addEventListener('click', (e) => {
            if (e.target === registrationWarningModal) {
              registrationWarningModal.classList.add('hidden');
            }
          });
        }

        // Hide/Show auth buttons based on login status
        function updateAuthButtons() {
          const isLoggedIn = localStorage.getItem('userLoggedIn') === 'true';
          const loginBtn = document.getElementById('loginBtn');
          const registerBtn = document.getElementById('registerBtn');
          const logoutBtn = document.getElementById('logoutBtn');
          if (loginBtn && registerBtn && logoutBtn) {
            if (isLoggedIn) {
              loginBtn.style.display = 'none';
              registerBtn.style.display = 'none';
              logoutBtn.style.display = 'block';
            } else {
              loginBtn.style.display = 'block';
              registerBtn.style.display = 'block';
              logoutBtn.style.display = 'none';
            }
          }
          // Show/hide My Receipts section based on login
          const myReceiptsSection = document.getElementById('myReceiptsSection');
          if (myReceiptsSection) {
            if (isLoggedIn) {
              myReceiptsSection.style.display = 'block';
              displayCustomerReceipts();
            } else {
              myReceiptsSection.style.display = 'none';
            }
          }
        }

        // Display customer's own receipts only
        function displayCustomerReceipts() {
          const currentUserId = localStorage.getItem('userId');
          if (!currentUserId) return;

          const customerNameDisplay = document.getElementById('customerNameDisplay');
          if (customerNameDisplay) {
            const userName = localStorage.getItem('userName') || 'User ' + currentUserId;
            customerNameDisplay.textContent = userName;
          }

          // Load from Firebase for this user only
          if (typeof firebase !== 'undefined' && firebase.database) {
            const db = firebase.database();
            db.ref(`users/${currentUserId}/payments`).once('value').then(snap => {
              const payments = snap.val() || {};
              const paymentArray = Array.isArray(payments) ? payments : Object.values(payments || {});
              
              displayCustomerPaymentsList(paymentArray);
            }).catch(err => {
              console.error('Error loading customer receipts:', err);
              const list = document.getElementById('customerReceiptsList');
              if (list) list.innerHTML = '<div class="empty-state">Error loading receipts</div>';
            });
          } else {
            // Fallback to localStorage
            const saved = localStorage.getItem('paymentData');
            if (saved) {
              try {
                const data = JSON.parse(saved);
                const allPayments = [...(data.approved || []), ...(data.pending || [])];
                displayCustomerPaymentsList(allPayments);
              } catch (e) {
                console.warn('Error parsing saved payments:', e);
              }
            }
          }
        }

        function displayCustomerPaymentsList(payments) {
          const list = document.getElementById('customerReceiptsList');
          if (!list) return;

          if (!payments || payments.length === 0) {
            list.innerHTML = `
              <div class="empty-state" style="text-align:center;padding:40px;color:#999;">
                <div style="font-size:48px;margin-bottom:10px;"></div>
                <div style="font-size:16px;">No receipts yet</div>
                <div style="font-size:12px;margin-top:10px;color:#666;">Make your first payment to see it here</div>
              </div>
            `;
            return;
          }

          list.innerHTML = payments.map(p => {
            const statusColor = p.status === 'approved' ? '#10b981' : '#f97316';
            const statusLabel = p.status === 'approved' ? ' APPROVED' : ' PENDING';
            
            return `
              <div style="background:linear-gradient(135deg,#1a1a1a,#0f0f0f);border:1px solid #333;border-left:4px solid ${statusColor};border-radius:8px;padding:20px;transition:all 0.3s ease;cursor:pointer;" onmouseover="this.style.borderColor='#0db0ff';this.style.boxShadow='0 0 20px rgba(13,176,255,0.2)'" onmouseout="this.style.borderColor='#333';this.style.boxShadow='none'">
                <div style="display:flex;justify-content:space-between;align-items:start;margin-bottom:15px;">
                  <div>
                    <div style="font-size:14px;color:#999;text-transform:uppercase;margin-bottom:4px;">Receipt Number</div>
                    <div style="font-weight:700;color:#0db0ff;font-size:16px;">#${p.id}</div>
                  </div>
                  <div style="background:${statusColor};color:#fff;padding:6px 12px;border-radius:4px;font-size:12px;font-weight:700;">
                    ${statusLabel}
                  </div>
                </div>

                <div style="display:grid;grid-template-columns:1fr 1fr;gap:15px;margin-bottom:15px;padding:15px;background:rgba(255,255,255,0.05);border-radius:6px;">
                  <div>
                    <div style="font-size:11px;color:#999;text-transform:uppercase;margin-bottom:4px;">Amount</div>
                    <div style="font-weight:700;color:#f2c94c;font-size:18px;">$${(p.amount || 0).toFixed(2)}</div>
                  </div>
                  <div>
                    <div style="font-size:11px;color:#999;text-transform:uppercase;margin-bottom:4px;">Payment Method</div>
                    <div style="font-weight:600;color:#0db0ff;">${p.paymentMethod || 'Not specified'}</div>
                  </div>
                </div>

                <div style="display:grid;grid-template-columns:1fr 1fr;gap:15px;margin-bottom:15px;">
                  <div>
                    <div style="font-size:11px;color:#999;text-transform:uppercase;margin-bottom:4px;">Date</div>
                    <div style="font-size:13px;color:#ccc;">${p.timestamp || 'No date'}</div>
                  </div>
                  <div>
                    <div style="font-size:11px;color:#999;text-transform:uppercase;margin-bottom:4px;">Type</div>
                    <div style="font-size:13px;color:#ccc;">${p.type || 'Standard'}</div>
                  </div>
                </div>

                <button onclick="window.viewCustomerReceipt && window.viewCustomerReceipt('${p.id}')" style="width:100%;padding:12px;background:linear-gradient(135deg,#0db0ff,#1db7ff);color:#fff;border:none;border-radius:6px;cursor:pointer;font-weight:600;transition:all 0.3s ease;font-size:14px;">
                   VIEW FULL RECEIPT
                </button>
              </div>
            `;
          }).join('');
        }

        // View receipt function
        window.viewCustomerReceipt = function(receiptId) {
          const currentUserId = localStorage.getItem('userId');
          if (!currentUserId) return;

          if (typeof firebase !== 'undefined' && firebase.database) {
            const db = firebase.database();
            db.ref(`users/${currentUserId}/payments/${receiptId}`).once('value').then(snap => {
              const payment = snap.val();
              if (payment && payment.full) {
                if (typeof showReceiptModalFromData === 'function') {
                  showReceiptModalFromData(payment.full);
                }
              }
            });
          }
        };

        // Initial check on page load
        updateAuthButtons();

        // Robust logout functionality: clears storage, signs out from Firebase if available,
        // updates UI and reloads. Listener is attached or delegated to work even if button
        // is added to DOM later.
        function performLogout(e) {
          if (e && typeof e.preventDefault === 'function') {
            try { e.preventDefault(); } catch (er) {}
            try { e.stopPropagation(); } catch (er) {}
          }
          console.log('DEBUG: performLogout invoked');
          try {
            if (typeof firebase !== 'undefined' && firebase.auth && firebase.auth().currentUser) {
              try { firebase.auth().signOut().catch(() => {}); } catch (e) {}
            }
          } catch (e) {}

          try { localStorage.removeItem('userLoggedIn'); } catch (e) {}
          try { localStorage.removeItem('userId'); } catch (e) {}
          try { localStorage.removeItem('userName'); } catch (e) {}
          try { sessionStorage.removeItem('userSession'); } catch (e) {}
          try { sessionStorage.removeItem('adminAuthenticated'); } catch (e) {}

          // extra clears for any other auth keys we've used
          try { localStorage.removeItem('authToken'); } catch (e) {}
          try { localStorage.removeItem('adminToken'); } catch (e) {}

          showNotification(' Logged out successfully!','success',{timeout:1400});
          updateAuthButtons();
          // No-op reload fallback: reload only if the UI still indicates logged-in after short delay
          setTimeout(() => {
            try {
              const still = localStorage.getItem('userLoggedIn') === 'true' || sessionStorage.getItem('userSession') === 'active';
              if (still) location.reload();
            } catch (e) { try { location.reload(); } catch (er) {} }
          }, 700);
        }

        // Attach or delegate click handler so it works regardless of load timing
        (function bindLogout() {
          let logoutBtn = document.getElementById('logoutBtn');
          if (logoutBtn) {
            try { logoutBtn.removeEventListener && logoutBtn.removeEventListener('click', performLogout); } catch (e) {}
            logoutBtn.addEventListener('click', performLogout);
          } else {
            // Delegate: if button is added later or replaced, this will catch clicks
            document.addEventListener('click', function(e) {
              const target = e.target || e.srcElement;
              if (!target) return;
              if (target.id === 'logoutBtn' || (target.closest && target.closest('#logoutBtn'))) {
                console.log('DEBUG: delegated logout click detected');
                performLogout();
              }
            });
          }
        })();

        // PERMANENT LOGOUT FIX: capture-phase listener that ALWAYS clears and reloads
        document.addEventListener('click', function logoutCaptureListener(e) {
          const btn = e.target;
          if (!btn) return;
          if (btn.id === 'logoutBtn' || btn.getAttribute('data-logout') === 'true') {
            console.log('=== LOGOUT BUTTON CLICKED (CAPTURE PHASE) ===');
            if (e.preventDefault) e.preventDefault();
            if (e.stopPropagation) e.stopPropagation();
            
            // Permanent: clear ALL storage (localStorage + sessionStorage) and reload
            try { localStorage.clear(); } catch (er) { console.warn('localStorage clear error:', er); }
            try { sessionStorage.clear(); } catch (er) { console.warn('sessionStorage clear error:', er); }
            
            console.log(' All storage cleared. Reloading page...');
            setTimeout(() => { 
              try {
                location.href = location.pathname; // Full page reload to the same URL
              } catch (er) {
                try { location.reload(true); } catch (e2) { window.location.reload(); }
              }
            }, 250);
          }
        }, true); // CAPTURE PHASE - runs before any other listeners

        window.logoutUser = function() {
          const btn = document.getElementById('logoutBtn');
          if (btn && btn.click) { 
            btn.click();
          } else {
            // Fallback: manually trigger logout
            console.log('Manual logout trigger');
            try { localStorage.clear(); } catch (e) {}
            try { sessionStorage.clear(); } catch (e) {}
            setTimeout(() => { location.reload(true); }, 200);
          }
        };
      }
      }); // END of DOMContentLoaded for button initialization
    })();

    // Betting Form Functionality  
    window.addEventListener('load', function() {
      console.log('=== Betting Form Initialized ===');
      
      setTimeout(() => {
      const betForm = document.querySelector('.betting-form');
      const paymentModal = document.getElementById('paymentModal');
      
      if (!betForm || !paymentModal) {
        console.error('Form or modal not found');
        return;
      }

      // Tab switching
      document.querySelectorAll('.tab-btn').forEach(btn => {
        btn.addEventListener('click', function() {
          document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
          this.classList.add('active');
        });
      });

      // Play type selection
      document.querySelectorAll('.play-type-btn').forEach(btn => {
        btn.addEventListener('click', function() {
          document.querySelectorAll('.play-type-btn').forEach(b => b.classList.remove('active'));
          this.classList.add('active');
        });
      });

      // Get form elements
      const totalBetEl = document.querySelector('.form-totals .total-item:nth-child(1) .total-value');
      const discountEl = document.querySelector('.form-totals .total-item:nth-child(2) .total-value');
      const afterDiscountEl = document.querySelector('.form-totals .total-item:nth-child(3) .total-value');
      const amountInputs = betForm.querySelectorAll('.amount-input');

      // Update totals
      function updateTotals() {
        let total = 0;
        amountInputs.forEach(input => {
          total += parseFloat(input.value) || 0;
        });
        const discount = Math.floor(total * 0.05);
        const afterDiscount = total - discount;
        
        if (totalBetEl) totalBetEl.textContent = total.toFixed(2);
        if (discountEl) discountEl.textContent = discount.toFixed(2);
        if (afterDiscountEl) afterDiscountEl.textContent = afterDiscount.toFixed(2);
      }

      amountInputs.forEach(input => {
        input.addEventListener('input', updateTotals);
      });

      // Refresh button
      const refreshIcon = document.querySelector('.refresh-icon');
      if (refreshIcon) {
        refreshIcon.addEventListener('click', function() {
          this.style.transform = 'rotate(360deg)';
          this.style.transition = 'transform 0.6s ease';
          setTimeout(() => { this.style.transform = 'rotate(0deg)'; }, 600);
        });
      }

      // Modal close button
      const modalClose = paymentModal.querySelector('.modal-close');
      if (modalClose) {
        modalClose.addEventListener('click', () => paymentModal.classList.add('hidden'));
      }

      // Close modal when clicking outside
      paymentModal.addEventListener('click', (e) => {
        if (e.target === paymentModal) paymentModal.classList.add('hidden');
      });

      // Form submission
      let betData = null;
      betForm.addEventListener('submit', function(e) {
        e.preventDefault();
        
        // Check if user is logged in
        if (!localStorage.getItem('userLoggedIn') || localStorage.getItem('userLoggedIn') !== 'true') {
          // Show beautiful notification instead of alert
          const notification = document.createElement('div');
          notification.style.cssText = 'position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);background:linear-gradient(135deg,#ff6b6b,#ff8e53);color:#fff;padding:40px;border-radius:15px;font-weight:700;z-index:3000;box-shadow:0 20px 60px rgba(255,107,107,0.4);animation:popIn 0.5s ease;max-width:400px;text-align:center;';
          notification.innerHTML = `
            <div style="font-size:48px;margin-bottom:20px;"></div>
            <div style="font-size:22px;margin-bottom:20px;line-height:1.5;">Please LOG IN first to place bets!</div>
            <div style="font-size:14px;opacity:0.9;margin-bottom:30px;">You need to login with your User ID to proceed</div>
            <button style="background:#fff;color:#ff6b6b;padding:12px 30px;border:none;border-radius:8px;font-weight:700;cursor:pointer;font-size:16px;transition:all 0.3s ease;" onclick="this.parentElement.remove(); document.getElementById('loginBtn').click();">
              GO TO LOGIN
            </button>
          `;
          document.body.appendChild(notification);
          setTimeout(() => {
            if (notification.parentElement) {
              notification.remove();
            }
          }, 5000);
          return;
        }
        
        const betRows = Array.from(betForm.querySelectorAll('.bet-row'));
        let totalAmount = 0;
        let bets = [];
        let numbersList = [];

        // Collect all number and amount values
        betRows.forEach((row, idx) => {
          const numberInput = row.querySelector('.bet-input');
          const amountInputs = row.querySelectorAll('.amount-input');
          
          amountInputs.forEach((input, amountIdx) => {
            const val = parseFloat(input.value) || 0;
            if (val > 0) {
              totalAmount += val;
              const number = numberInput?.value || '-';
              numbersList.push({
                number: number,
                amount: val
              });
              bets.push({ row: idx, amount: val, number: number });
            }
          });
        });

        if (totalAmount === 0) {
          showNotification('Please enter at least one amount!','warn',{timeout:3000});
          return;
        }

        // Get play type
        const activePlayType = document.querySelector('.play-type-btn.active');
        const playType = activePlayType ? activePlayType.dataset.type : '3up';

        const totalBet = parseFloat(totalBetEl?.textContent) || totalAmount;
        const discount = Math.floor(totalBet * 0.05);
        const finalAmount = totalBet - discount;

        betData = {
          playType: playType,
          count: bets.length,
          totalBet: totalBet,
          discount: discount,
          finalAmount: finalAmount,
          numbers: numbersList
        };

        console.log('Bet submitted:', betData);

        // Update modal
        const summaryDetails = document.getElementById('summaryDetails');
        const summaryTotal = document.getElementById('summaryTotal');
        const summaryDiscount = document.getElementById('summaryDiscount');
        const summaryFinal = document.getElementById('summaryFinal');

        if (summaryDetails) summaryDetails.textContent = `${playType.toUpperCase()} - ${bets.length} bet(s)`;
        if (summaryTotal) summaryTotal.textContent = '$' + totalBet.toFixed(2);
        if (summaryDiscount) summaryDiscount.textContent = '$' + discount.toFixed(2);
        if (summaryFinal) summaryFinal.textContent = '$' + finalAmount.toFixed(2);

        // Show modal
        paymentModal.classList.remove('hidden');
      });

      // Payment method buttons: add pending payment and DO NOT show receipt to customer until approved
        document.querySelectorAll('.payment-method-btn').forEach(btn => {
        btn.addEventListener('click', function() {
          if (!betData) { showNotification('Please submit a bet first','warn',{timeout:3000}); return; }

          const paymentMethod = this.querySelector('span').textContent;
          
          // Map payment methods to their respective Google Form URLs
          const formUrlMap = {
            'bKash': 'https://forms.gle/XCiqjfwrhFLMyncy5',
            'Google Pay': 'https://forms.gle/JJzEgJL2ccuEFF8XA',
            'Phone Pay': 'https://forms.gle/JJzEgJL2ccuEFF8XA',
            'Paytm': 'https://forms.gle/JJzEgJL2ccuEFF8XA'
          };
          const googleFormUrl = formUrlMap[paymentMethod] || 'https://forms.gle/XCiqjfwrhFLMyncy5';

          // Open payment form (external)
          const paymentWindow = window.open(googleFormUrl, 'PaymentForm', 'width=700,height=800');
          if (!paymentWindow) { showNotification(' Popup blocked! Please allow popups.','warn',{timeout:4000}); return; }

          // Close payment modal UI
          paymentModal.classList.add('hidden');

          // Generate identifiers
          const receiptNumber = 'RCP-' + Math.random().toString(36).substr(2, 9).toUpperCase();
          const transactionId = 'TXN-' + Date.now() + '-' + Math.random().toString(36).substr(2, 6).toUpperCase();
          const now = new Date();
          const dateTime = now.toLocaleDateString() + ' ' + now.toLocaleTimeString();

          // Build full receipt data object
          const receiptData = {
            receiptNumber,
            transactionId,
            dateTime,
            playType: betData.playType.toUpperCase(),
            count: betData.count,
            totalBet: betData.totalBet,
            discount: betData.discount,
            finalAmount: betData.finalAmount,
            paymentMethod,
            numbers: betData.numbers
          };

          // Add to pending (stores full data)
          addPendingPayment(receiptData);

          // Remember this pending receipt for this browser session so customer can check later
          sessionStorage.setItem('lastPendingReceiptId', receiptNumber);

          // Show a persistent banner so the customer knows it's pending approval
          showPendingBanner(receiptNumber, receiptData.finalAmount);

          // Reset form after delay
          setTimeout(() => { betForm.reset(); updateTotals(); }, 2000);
        });
      });
      }, 100); // setTimeout end for DOM readiness
    });

    // ADMIN APPROVAL SYSTEM
    let pendingPayments = [];
    let approvedPayments = [];

    // Debug: All initialization complete
    window.addEventListener('load', function() {
      console.log('%c ALL SYSTEMS READY', 'color: #10b981; font-size: 14px; font-weight: bold;');
      console.log({
        loginBtn: !!document.getElementById('loginBtn'),
        registerBtn: !!document.getElementById('registerBtn'),
        logoutBtn: !!document.getElementById('logoutBtn'),
        bettingForm: !!document.querySelector('.betting-form'),
        adminPanel: !!document.getElementById('adminPanel'),
        firebaseReady: typeof firebase !== 'undefined',
        modals: {
          login: !!document.getElementById('loginModal'),
          payment: !!document.getElementById('paymentModal'),
          receipt: !!document.getElementById('receiptModal'),
          admin: !!document.getElementById('adminPanel')
        }
      });
    }, { once: true });

    // Load data from Firebase/localStorage
    function loadPayments(callback) {
      loadPaymentsFromFirebase(function(pending, approved) {
        pendingPayments = pending;
        approvedPayments = approved;
        if (callback) callback();
      });
    }

    // Save data to Firebase/localStorage
    function savePayments() {
      savePaymentsToFirebase(pendingPayments, approvedPayments);
    }

    // Add new pending payment
    function addPendingPayment(receiptData) {
      const payment = {
        id: receiptData.receiptNumber,
        timestamp: new Date().toLocaleString(),
        amount: receiptData.finalAmount,
        transactionId: receiptData.transactionId,
        paymentMethod: receiptData.paymentMethod,
        numbers: receiptData.numbers,
        status: 'pending',
        full: receiptData
      };
      pendingPayments.unshift(payment);
      savePayments();
      updateAdminPanel();
    }

    // Update admin panel display
    function updateAdminPanel() {
      const pendingList = document.getElementById('pendingPaymentsList');
      const approvedList = document.getElementById('approvedPaymentsList');

      // Update pending list
      pendingList.innerHTML = pendingPayments.map(payment => `
        <div class="payment-item" data-id="${payment.id}">
          <div style="display:flex;justify-content:space-between;margin-bottom:12px;">
            <div>
              <div style="font-weight:700;color:#333;">Receipt #${payment.id}</div>
              <div style="font-size:12px;color:#999;margin-top:4px;">${payment.timestamp}</div>
            </div>
            <div style="text-align:right;">
              <div style="font-size:12px;background:#ff9500;color:#fff;padding:4px 12px;border-radius:4px;display:inline-block;margin-bottom:4px;">PENDING</div>
            </div>
          </div>
          <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-bottom:12px;padding-bottom:12px;border-bottom:1px solid #eee;">
            <div>
              <div style="font-size:11px;color:#999;text-transform:uppercase;margin-bottom:4px;">Amount</div>
              <div style="font-weight:700;color:#333;font-size:16px;">$${payment.amount.toFixed(2)}</div>
            </div>
            <div>
              <div style="font-size:11px;color:#999;text-transform:uppercase;margin-bottom:4px;">Method</div>
              <div style="font-weight:600;color:#0db0ff;">${payment.paymentMethod}</div>
            </div>
          </div>
            <div style="display:flex;gap:12px;">
            <button onclick="approvePayment('${payment.id}')" style="flex:1;padding:10px;background:linear-gradient(135deg,#10b981,#059669);color:#fff;border:none;border-radius:6px;font-weight:600;cursor:pointer;font-size:14px;transition:all 0.3s ease;">
               Approve
            </button>
            <button onclick="rejectPayment('${payment.id}')" style="flex:1;padding:10px;background:#e5e7eb;color:#374151;border:none;border-radius:6px;font-weight:600;cursor:pointer;font-size:14px;transition:all 0.3s ease;">
               Reject
            </button>
            <button onclick="viewPendingReceipt('${payment.id}')" style="flex:1;padding:10px;background:#0db0ff;color:#fff;border:none;border-radius:6px;font-weight:600;cursor:pointer;font-size:14px;transition:all 0.3s ease;">
               View
            </button>
          </div>
        </div>
      `).join('');

      // Update approved list
      approvedList.innerHTML = approvedPayments.map(payment => `
        <div class="payment-item" style="background:#f0fdf4;">
          <div style="display:flex;justify-content:space-between;margin-bottom:12px;">
            <div>
              <div style="font-weight:700;color:#333;">Receipt #${payment.id}</div>
              <div style="font-size:12px;color:#999;margin-top:4px;">${payment.timestamp}</div>
            </div>
            <div style="text-align:right;">
              <div style="font-size:12px;background:#10b981;color:#fff;padding:4px 12px;border-radius:4px;display:inline-block;margin-bottom:4px;">APPROVED</div>
            </div>
          </div>
          <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px;padding:12px;background:#fff;border-radius:4px;">
            <div>
              <div style="font-size:11px;color:#999;text-transform:uppercase;margin-bottom:4px;">Amount</div>
              <div style="font-weight:700;color:#10b981;font-size:16px;">$${payment.amount.toFixed(2)}</div>
            </div>
            <div>
              <div style="font-size:11px;color:#999;text-transform:uppercase;margin-bottom:4px;">Method</div>
              <div style="font-weight:600;color:#059669;">${payment.paymentMethod}</div>
            </div>
          </div>
        </div>
      `).join('');

      if (pendingPayments.length === 0) {
        pendingList.innerHTML = '<div style="text-align:center;padding:40px 20px;color:#999;">No pending payments</div>';
      }
      if (approvedPayments.length === 0) {
        approvedList.innerHTML = '<div style="text-align:center;padding:40px 20px;color:#999;">No approved payments</div>';
      }
    }

    // Approve payment
    function approvePayment(receiptId) {
      const paymentIndex = pendingPayments.findIndex(p => p.id === receiptId);
      if (paymentIndex !== -1) {
        const payment = pendingPayments[paymentIndex];
        payment.status = 'approved';
        // move full payment into approved list
        approvedPayments.unshift(payment);
        pendingPayments.splice(paymentIndex, 1);
        savePayments();
        updateAdminPanel();

        // If this browser session initiated the payment, reveal the receipt to the user
        const lastPendingId = sessionStorage.getItem('lastPendingReceiptId');
        if (lastPendingId && lastPendingId === receiptId) {
          // populate and show receipt modal using stored full data
          if (payment.full) showReceiptModalFromData(payment.full);
          // update pending banner if present
          updatePendingBannerStatus(receiptId, 'approved');
        }

        // Update receipt modal if open for other viewers
        const receiptNumberElement = document.getElementById('receiptNumber');
        if (receiptNumberElement && receiptNumberElement.textContent.includes(receiptId)) {
          document.getElementById('receiptStatus').innerHTML = '<div style="color:#10b981;font-weight:700;"> APPROVED</div>';
          document.getElementById('approvalNotice').style.display = 'none';
        }

        // Show approval notification
        const notification = document.createElement('div');
        notification.style.cssText = 'position:fixed;top:20px;right:20px;background:linear-gradient(135deg,#10b981,#059669);color:#fff;padding:20px 24px;border-radius:8px;font-weight:700;z-index:2000;box-shadow:0 8px 24px rgba(16,185,129,0.4);';
        notification.innerHTML = `<div> Payment #${receiptId} Approved</div>`;
        document.body.appendChild(notification);
        setTimeout(() => notification.remove(), 2000);
      }
    }

    // Reject payment
    function rejectPayment(receiptId) {
      if (confirm('Are you sure you want to reject this payment? This action cannot be undone.')) {
        const paymentIndex = pendingPayments.findIndex(p => p.id === receiptId);
        if (paymentIndex !== -1) {
          pendingPayments.splice(paymentIndex, 1);
          savePayments();
          updateAdminPanel();

          // Show rejection notification
          const notification = document.createElement('div');
          notification.style.cssText = 'position:fixed;top:20px;right:20px;background:linear-gradient(135deg,#ef4444,#dc2626);color:#fff;padding:20px 24px;border-radius:8px;font-weight:700;z-index:2000;box-shadow:0 8px 24px rgba(239,68,68,0.4);';
          notification.innerHTML = `<div> Payment #${receiptId} Rejected</div>`;
          document.body.appendChild(notification);
          setTimeout(() => notification.remove(), 2000);
        }
      }
    }

    // Show a small persistent banner for the customer when a payment is pending
    function showPendingBanner(receiptId, amount) {
      // remove existing
      const existing = document.getElementById('pendingReceiptBanner');
      if (existing) existing.remove();

      const banner = document.createElement('div');
      banner.id = 'pendingReceiptBanner';
      banner.style.cssText = 'position:fixed;bottom:80px;left:20px;background:#111;border:1px solid rgba(255,200,87,0.12);padding:12px 16px;border-radius:8px;color:#fff;z-index:2100;box-shadow:0 8px 24px rgba(0,0,0,0.6);max-width:320px;animation:slideLeft 0.5s cubic-bezier(0.34,1.56,0.64,1);';
      banner.innerHTML = `
        <div style="font-weight:800;color:#f2c94c;margin-bottom:6px;animation:slideDown 0.4s ease;">Receipt ${receiptId}</div>
        <div style="font-size:13px;color:#9aa0a6;margin-bottom:8px;animation:slideLeft 0.5s ease 0.1s backwards;">Amount: $${amount.toFixed(2)}  Status: <span id="pendingStatus_${receiptId}" style="color:#ffb547;font-weight:700;animation:pulse 2s ease infinite;">PENDING</span></div>
        <div style="display:flex;gap:8px;animation:slideLeft 0.5s ease 0.2s backwards;">
          <button id="viewReceiptBtn" style="flex:1;padding:8px;border-radius:6px;border:none;background:#2b2b2b;color:#9aa0a6;cursor:not-allowed;transition:all 0.3s ease;" disabled>
            View Receipt
          </button>
          <button id="copyReceiptBtn" style="padding:8px;border-radius:6px;border:none;background:#0db0ff;color:#fff;cursor:pointer;transition:all 0.3s ease;">Copy ID</button>
        </div>
      `;
      document.body.appendChild(banner);

      const copyBtn = document.getElementById('copyReceiptBtn');
      if (copyBtn) {
        copyBtn.addEventListener('click', () => { navigator.clipboard.writeText(receiptId); copyBtn.textContent = 'Copied'; copyBtn.style.animation='pulse 0.5s ease'; setTimeout(()=>{ copyBtn.textContent='Copy ID'; copyBtn.style.animation='none'; },1200); });
        copyBtn.addEventListener('mouseenter', () => { copyBtn.style.transform='translateY(-2px)'; copyBtn.style.boxShadow='0 4px 12px rgba(13,176,255,0.4)'; });
        copyBtn.addEventListener('mouseleave', () => { copyBtn.style.transform='translateY(0)'; copyBtn.style.boxShadow='none'; });
      }

      // view button remains disabled until admin approves; if approved later it will be enabled by updatePendingBannerStatus
    }

    function updatePendingBannerStatus(receiptId, status) {
      const statusEl = document.getElementById('pendingStatus_' + receiptId);
      const viewBtn = document.getElementById('viewReceiptBtn');
      if (statusEl) {
        if (status === 'approved') {
          statusEl.textContent = 'APPROVED';
          statusEl.style.color = '#10b981';
          // enable view button
          if (viewBtn) { viewBtn.style.cursor='pointer'; viewBtn.style.background='#0db0ff'; viewBtn.style.color='#fff'; viewBtn.onclick = () => { const payment = approvedPayments.find(p => p.id === receiptId); if (payment && payment.full) showReceiptModalFromData(payment.full); } }
        } else if (status === 'rejected') {
          statusEl.textContent = 'REJECTED';
          statusEl.style.color = '#ef4444';
          if (viewBtn) { viewBtn.style.cursor='not-allowed'; viewBtn.style.background='#2b2b2b'; viewBtn.style.color='#9aa0a6'; }
        }
      }
    }

    function viewPendingReceipt(receiptId) {
      const payment = pendingPayments.find(p => p.id === receiptId);
      if (payment && payment.full) {
        // show admin preview (can show pending state)
        showReceiptModalFromData(payment.full, true);
      } else {
        showNotification('Receipt not found or already approved.','warn',{timeout:3500});
      }
    }

    function showReceiptModalFromData(data, allowPendingView=false) {
      const receiptModal = document.getElementById('receiptModal');
      if (!receiptModal) return;
      document.getElementById('receiptNumber').textContent = data.receiptNumber;
      document.getElementById('receiptDateTime').textContent = data.dateTime || new Date().toLocaleString();
      document.getElementById('receiptPlayType').textContent = (data.playType||'').toUpperCase();
      document.getElementById('receiptBetCount').textContent = data.count || 0;
      document.getElementById('receiptTotalAmount').textContent = '$' + (data.totalBet||0).toFixed(2);
      document.getElementById('receiptDiscountAmount').textContent = '$' + (data.discount||0).toFixed(2);
      document.getElementById('receiptFinalAmount').textContent = '$' + (data.finalAmount||0).toFixed(2);
      document.getElementById('receiptPaymentMethod').textContent = data.paymentMethod || '-';
      document.getElementById('receiptTransactionId').textContent = data.transactionId || '-';
      const numbersList = document.getElementById('receiptNumbersList');
      if (numbersList && data.numbers && data.numbers.length > 0) {
        numbersList.innerHTML = data.numbers.map(item => `<div class="receipt-number-item"><span>Number: ${item.number||'-'}</span><span>$${(item.amount||0).toFixed(2)}</span></div>`).join('');
      }
      // set status
      if (allowPendingView) {
        document.getElementById('receiptStatus').innerHTML = '<div style="color:#ffb547;font-weight:700;"> PENDING APPROVAL</div>';
        document.getElementById('approvalNotice').style.display = 'block';
      } else {
        document.getElementById('receiptStatus').innerHTML = '<div style="color:#10b981;font-weight:700;"> APPROVED</div>';
        document.getElementById('approvalNotice').style.display = 'none';
      }
      receiptModal.classList.remove('hidden');
      
      // Add close button handler
      const receiptClose = receiptModal.querySelector('.modal-close');
      if (receiptClose) {
        receiptClose.onclick = () => receiptModal.classList.add('hidden');
      }
      
      // Close when clicking outside
      receiptModal.addEventListener('click', (e) => {
        if (e.target === receiptModal) receiptModal.classList.add('hidden');
      });
      
      // Add print and download button handlers
     
      const printBtn = document.getElementById('printReceiptBtn');
      if (printBtn) printBtn.onclick = () => window.print();
      
      const downloadBtn = document.getElementById('downloadReceiptBtn');
      if (downloadBtn) {
        downloadBtn.onclick = () => {
          const receiptHtml = receiptModal.querySelector('.receipt-body').outerHTML;
          const title = document.getElementById('receiptNumber') ? document.getElementById('receiptNumber').textContent : 'Receipt';
          const w = window.open('', '_blank');
          const doc = `<!doctype html><html><head><meta charset="utf-8"><title>${title}</title>
            <meta name="viewport" content="width=device-width,initial-scale=1">
            <style>body{background:#0a0a0a;color:#fff;font-family:Arial,Helvetica,sans-serif;padding:20px} .receipt-body{max-width:720px;margin:0 auto;} .receipt-title{color:#f2c94c;font-weight:800;font-size:20px;margin-bottom:8px;} .receipt-number-item{display:flex;justify-content:space-between;padding:8px;border-left:4px solid #f2c94c;margin-bottom:6px;background:rgba(0,0,0,0.2);} .receipt-label{color:#9aa0a6;font-size:12px;margin-top:6px;} .receipt-value{color:#fff;font-weight:700;} </style>
            </head><body>${receiptHtml}</body></html>`;
          w.document.write(doc);
          w.document.close();
          w.focus();
          setTimeout(()=>{ w.print(); }, 500);
        };
      }
    }

    // --- Admin authentication helpers (client-side) ---
    async function hashString(str) {
      const enc = new TextEncoder();
      const data = enc.encode(str);
      const hash = await crypto.subtle.digest('SHA-256', data);
      const arr = Array.from(new Uint8Array(hash));
      return arr.map(b => b.toString(16).padStart(2, '0')).join('');
    }

    async function setAdminPassword(pw) {
      const h = await hashString(pw);
      localStorage.setItem('adminPassHash', h);
    }

    async function checkAdminPassword(pw) {
      const stored = localStorage.getItem('adminPassHash');
      if (!stored) return false;
      const h = await hashString(pw);
      return h === stored;
    }

    async function ensureAdminAuthenticated() {
      if (sessionStorage.getItem('adminAuthenticated') === 'true') return true;
      const stored = localStorage.getItem('adminPassHash');
      if (!stored) {
        const create = prompt('No admin password set. Enter a new admin password:');
        if (!create) return false;
        const confirm = prompt('Confirm new admin password:');
        if (create !== confirm) { showNotification('Passwords do not match. Try again.','warn',{timeout:3500}); return false; }
        await setAdminPassword(create);
        showNotification('Admin password saved. Please login.','success',{timeout:2500});
      }
      const attempt = prompt('Enter admin password:');
      if (!attempt) return false;
      const ok = await checkAdminPassword(attempt);
      if (!ok) { showNotification('Incorrect password.','warn',{timeout:3000}); return false; }
      sessionStorage.setItem('adminAuthenticated', 'true');
      return true;
    }

    // Admin panel toggle button
    const adminToggleBtn = document.getElementById('adminToggleBtn');
    const adminPanel = document.getElementById('adminPanel');
    const adminClose = document.getElementById('adminClose');
    
    // Tab buttons for admin panel
    const viewApprovalBtn = document.getElementById('viewApprovalBtn');
    const viewAllUsersBtn = document.getElementById('viewAllUsersBtn');
    const approvalView = document.getElementById('approvalView');
    const allUsersView = document.getElementById('allUsersView');

    if (viewApprovalBtn && viewAllUsersBtn && approvalView && allUsersView) {
      viewApprovalBtn.addEventListener('click', () => {
        viewApprovalBtn.style.background = '#0db0ff';
        viewApprovalBtn.style.color = '#fff';
        viewAllUsersBtn.style.background = 'rgba(255,255,255,0.1)';
        viewAllUsersBtn.style.color = '#fff';
        approvalView.style.display = 'block';
        allUsersView.style.display = 'none';
      });

      viewAllUsersBtn.addEventListener('click', () => {
        viewAllUsersBtn.style.background = '#0db0ff';
        viewAllUsersBtn.style.color = '#fff';
        viewApprovalBtn.style.background = 'rgba(255,255,255,0.1)';
        viewApprovalBtn.style.color = '#fff';
        approvalView.style.display = 'none';
        allUsersView.style.display = 'block';
        
        // Load all users data
        if (typeof firebase !== 'undefined' && firebase.database) {
          const db = firebase.database();
          db.ref('users').once('value').then(snap => {
            const users = snap.val() || {};
            displayAllUsers(users);
          }).catch(err => {
            console.error('Error loading users:', err);
            document.getElementById('allUsersList').innerHTML = '<div class="empty-state">Error loading users data</div>';
          });
        }
      });

      // Search functionality with smart filtering
      const userSearchInput = document.getElementById('userSearchInput');
      if (userSearchInput) {
        userSearchInput.addEventListener('input', (e) => {
          const query = e.target.value.toLowerCase().trim();
          
          if (!query) {
            // Reset to full list
            currentPage = 1;
            displayUsersPage();
            return;
          }

          // Filter users by User ID, Name, or payment details
          const filteredUsers = allUsersData.filter(user => {
            const userIdMatch = user.userId.toLowerCase().includes(query);
            const nameMatch = (user.userName || '').toLowerCase().includes(query);
            const payments = Array.isArray(user.payments) ? user.payments : Object.values(user.payments || {});
            const hasPaymentMatch = payments.some(p => 
              p.id?.toLowerCase().includes(query) || 
              p.amount?.toString().includes(query)
            );
            return userIdMatch || nameMatch || hasPaymentMatch;
          });

          // Display filtered results
          const allUsersList = document.getElementById('allUsersList');
          if (filteredUsers.length === 0) {
            allUsersList.innerHTML = `
              <div class="empty-state" style="text-align:center;padding:40px;color:#999;">
                <div style="font-size:48px;margin-bottom:10px;"></div>
                <div style="font-size:16px;">No results found for "${e.target.value}"</div>
                <div style="font-size:12px;margin-top:10px;color:#666;">Try searching by name, User ID or amount</div>
              </div>
            `;
            return;
          }

          // Display filtered results (no pagination for search)
          allUsersList.innerHTML = filteredUsers.map(user => {
            const payments = Array.isArray(user.payments) ? user.payments : Object.values(user.payments);
            const totalAmount = payments.reduce((sum, p) => sum + (p.amount || 0), 0);
            const approvedCount = payments.filter(p => p.status === 'approved').length;
            const pendingCount = payments.filter(p => p.status !== 'approved').length;

            return `
              <div data-user-id="${user.userId}" style="background:#1a1a1a;border:1px solid #333;border-radius:8px;padding:16px;transition:all 0.3s ease;">
                <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px;">
                  <div>
                    <div style="font-weight:700;color:#f2c94c;font-size:16px;">${user.userName || 'User ' + user.userId}</div>
                    <div style="font-size:12px;color:#0db0ff;margin-top:4px;">ID: ${user.userId}</div>
                    <div style="font-size:11px;color:#999;margin-top:2px;">Last Synced: ${user.lastSynced ? new Date(user.lastSynced).toLocaleString() : 'Never'}</div>
                  </div>
                  <div style="text-align:right;">
                    <div style="font-size:20px;font-weight:700;color:#10b981;">$${totalAmount.toFixed(2)}</div>
                    <div style="font-size:11px;color:#999;">Total Amount</div>
                  </div>
                </div>

                <div style="display:grid;grid-template-columns:1fr 1fr 1fr;gap:8px;margin-bottom:12px;padding:12px;background:rgba(255,255,255,0.05);border-radius:4px;">
                  <div style="text-align:center;">
                    <div style="font-size:18px;font-weight:700;color:#10b981;">${approvedCount}</div>
                    <div style="font-size:11px;color:#999;">Approved</div>
                  </div>
                  <div style="text-align:center;">
                    <div style="font-size:18px;font-weight:700;color:#f97316;">${pendingCount}</div>
                    <div style="font-size:11px;color:#999;">Pending</div>
                  </div>
                  <div style="text-align:center;">
                    <div style="font-size:18px;font-weight:700;color:#0db0ff;">${payments.length}</div>
                    <div style="font-size:11px;color:#999;">Total</div>
                  </div>
                </div>

                <button onclick="toggleUserPayments('${user.userId}')" style="width:100%;padding:10px;background:linear-gradient(135deg,#0db0ff,#1db7ff);color:#fff;border:none;border-radius:6px;cursor:pointer;font-weight:600;transition:all 0.3s ease;">
                   View Payments (${payments.length})
                </button>

                <div id="payments-${user.userId}" style="display:none;margin-top:12px;max-height:300px;overflow-y:auto;">
                  ${payments.length === 0 ? '<div class="empty-state">No payments</div>' : 
                    payments.map((p, idx) => `
                      <div style="background:#0a0a0a;padding:10px;border-radius:4px;margin-bottom:8px;border-left:3px solid ${p.status === 'approved' ? '#10b981' : '#f97316'};">
                        <div style="display:flex;justify-content:space-between;margin-bottom:4px;">
                          <div style="font-weight:600;color:#fff;">Receipt #${p.id}</div>
                          <div style="font-size:12px;background:${p.status === 'approved' ? '#10b981' : '#f97316'};color:#fff;padding:2px 8px;border-radius:3px;">${p.status === 'approved' ? ' Approved' : ' Pending'}</div>
                        </div>
                        <div style="font-size:13px;color:#f2c94c;font-weight:700;">$${p.amount?.toFixed(2) || '0.00'}</div>
                        <div style="font-size:11px;color:#999;margin-top:4px;">${p.timestamp || 'No date'}</div>
                      </div>
                    `).join('')
                  }
                </div>
              </div>
            `;
          }).join('');
        });
      }
    }

    // Global pagination state
    let allUsersData = [];
    let currentPage = 1;
    const itemsPerPage = 10; // 10 users per page

    // Function to display all users and their payments with pagination
    function displayAllUsers(users) {
      const allUsersList = document.getElementById('allUsersList');
      if (!allUsersList) return;

      // Store all users data globally for pagination
      allUsersData = Object.entries(users).map(([uid, userData]) => ({
        userId: uid,
        userName: userData.profile?.name || '',
        payments: userData.payments || {},
        lastSynced: userData.lastSynced
      }));

      if (allUsersData.length === 0) {
        allUsersList.innerHTML = '<div class="empty-state">No users found</div>';
        return;
      }

      // Reset to first page
      currentPage = 1;
      displayUsersPage();
    }

    // Display current page of users
    function displayUsersPage() {
      const allUsersList = document.getElementById('allUsersList');
      if (!allUsersList) return;

      const startIdx = (currentPage - 1) * itemsPerPage;
      const endIdx = startIdx + itemsPerPage;
      const pageUsers = allUsersData.slice(startIdx, endIdx);

      let html = pageUsers.map(user => {
        const payments = Array.isArray(user.payments) ? user.payments : Object.values(user.payments);
        const totalAmount = payments.reduce((sum, p) => sum + (p.amount || 0), 0);
        const approvedCount = payments.filter(p => p.status === 'approved').length;
        const pendingCount = payments.filter(p => p.status !== 'approved').length;

        return `
          <div data-user-id="${user.userId}" style="background:#1a1a1a;border:1px solid #333;border-radius:8px;padding:16px;transition:all 0.3s ease;">
            <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px;">
              <div>
                <div style="font-weight:700;color:#f2c94c;font-size:16px;">${user.userName || 'User ' + user.userId}</div>
                <div style="font-size:12px;color:#0db0ff;margin-top:2px;">ID: ${user.userId}</div>
                <div style="font-size:11px;color:#999;margin-top:2px;">Last Synced: ${user.lastSynced ? new Date(user.lastSynced).toLocaleString() : 'Never'}</div>
              </div>
              <div style="text-align:right;">
                <div style="font-size:20px;font-weight:700;color:#f2c94c;">$${totalAmount.toFixed(2)}</div>
                <div style="font-size:11px;color:#999;">Total Amount</div>
              </div>
            </div>

            <div style="display:grid;grid-template-columns:1fr 1fr 1fr;gap:8px;margin-bottom:12px;padding:12px;background:rgba(255,255,255,0.05);border-radius:4px;">
              <div style="text-align:center;">
                <div style="font-size:18px;font-weight:700;color:#10b981;">${approvedCount}</div>
                <div style="font-size:11px;color:#999;">Approved</div>
              </div>
              <div style="text-align:center;">
                <div style="font-size:18px;font-weight:700;color:#f97316;">${pendingCount}</div>
                <div style="font-size:11px;color:#999;">Pending</div>
              </div>
              <div style="text-align:center;">
                <div style="font-size:18px;font-weight:700;color:#0db0ff;">${payments.length}</div>
                <div style="font-size:11px;color:#999;">Total</div>
              </div>
            </div>

            <button onclick="toggleUserPayments('${user.userId}')" style="width:100%;padding:10px;background:linear-gradient(135deg,#0db0ff,#1db7ff);color:#fff;border:none;border-radius:6px;cursor:pointer;font-weight:600;transition:all 0.3s ease;">
               View Payments (${payments.length})
            </button>

            <div id="payments-${user.userId}" style="display:none;margin-top:12px;max-height:300px;overflow-y:auto;">
              ${payments.length === 0 ? '<div class="empty-state">No payments</div>' : 
                payments.map((p, idx) => `
                  <div style="background:#0a0a0a;padding:10px;border-radius:4px;margin-bottom:8px;border-left:3px solid ${p.status === 'approved' ? '#10b981' : '#f97316'};">
                    <div style="display:flex;justify-content:space-between;margin-bottom:4px;">
                      <div style="font-weight:600;color:#fff;">Receipt #${p.id}</div>
                      <div style="font-size:12px;background:${p.status === 'approved' ? '#10b981' : '#f97316'};color:#fff;padding:2px 8px;border-radius:3px;">${p.status === 'approved' ? ' Approved' : ' Pending'}</div>
                    </div>
                    <div style="font-size:13px;color:#f2c94c;font-weight:700;">$${p.amount?.toFixed(2) || '0.00'}</div>
                    <div style="font-size:11px;color:#999;margin-top:4px;">${p.timestamp || 'No date'}</div>
                  </div>
                `).join('')
              }
            </div>
          </div>
        `;
      }).join('');

      // Add pagination controls
      const totalPages = Math.ceil(allUsersData.length / itemsPerPage);
      if (totalPages > 1) {
        html += `
          <div style="display:flex;justify-content:center;align-items:center;gap:12px;margin-top:20px;padding:20px;background:rgba(255,255,255,0.05);border-radius:8px;">
            <button onclick="goToPreviousPage()" ${currentPage === 1 ? 'disabled' : ''} style="padding:10px 16px;background:${currentPage === 1 ? '#333' : '#0db0ff'};color:#fff;border:none;border-radius:4px;cursor:${currentPage === 1 ? 'not-allowed' : 'pointer'};font-weight:600;transition:all 0.3s;">
               Previous
            </button>
            <div style="color:#fff;font-weight:600;">
              Page <span style="color:#f2c94c;">${currentPage}</span> of <span style="color:#f2c94c;">${totalPages}</span>
            </div>
            <button onclick="goToNextPage()" ${currentPage === totalPages ? 'disabled' : ''} style="padding:10px 16px;background:${currentPage === totalPages ? '#333' : '#0db0ff'};color:#fff;border:none;border-radius:4px;cursor:${currentPage === totalPages ? 'not-allowed' : 'pointer'};font-weight:600;transition:all 0.3s;">
              Next 
            </button>
          </div>
          <div style="text-align:center;color:#999;font-size:12px;margin-top:12px;">
            Showing ${startIdx + 1}-${Math.min(endIdx, allUsersData.length)} of ${allUsersData.length} users
          </div>
        `;
      }

      allUsersList.innerHTML = html;
    }

    // Pagination functions
    window.goToNextPage = function() {
      const totalPages = Math.ceil(allUsersData.length / itemsPerPage);
      if (currentPage < totalPages) {
        currentPage++;
        displayUsersPage();
      }
    };

    window.goToPreviousPage = function() {
      if (currentPage > 1) {
        currentPage--;
        displayUsersPage();
      }
    };

    // Toggle user payments visibility
    window.toggleUserPayments = function(userId) {
      const container = document.getElementById(`payments-${userId}`);
      if (container) {
        container.style.display = container.style.display === 'none' ? 'block' : 'none';
      }
    };

    if (adminToggleBtn && adminPanel && adminClose) {
      adminToggleBtn.addEventListener('click', async () => {
        const ok = await ensureAdminAuthenticated();
        if (!ok) return;
        adminPanel.classList.toggle('active');
        adminPanel.classList.remove('hidden');
        loadPayments(function() {
          updateAdminPanel();
        });
      });

      // header admin button (opens same panel)
      const adminHeaderBtn = document.getElementById('adminHeaderBtn');
      if (adminHeaderBtn) {
        adminHeaderBtn.addEventListener('click', async () => {
          const ok = await ensureAdminAuthenticated();
          if (!ok) return;
          adminPanel.classList.remove('hidden');
          adminPanel.classList.add('active');
          loadPayments(function() {
            updateAdminPanel();
          });
          // scroll admin panel content to top
          const body = adminPanel.querySelector('.admin-body');
          if (body) body.scrollTop = 0;
        });
      }

      adminClose.addEventListener('click', () => {
        adminPanel.classList.remove('active');
        adminPanel.classList.add('hidden');
      });
    }

    // Load payments on page load
    loadPayments();
    updateAdminPanel();

    // If the current browser session initiated a pending receipt, show banner or reveal if already approved
    (function initPendingUI() {
      const lastPendingId = sessionStorage.getItem('lastPendingReceiptId');
      if (!lastPendingId) return;
      // if still pending, show banner
      const pending = pendingPayments.find(p => p.id === lastPendingId);
      if (pending) {
        showPendingBanner(pending.id, pending.amount || 0);
        return;
      }
      // if approved, show receipt modal
      const approved = approvedPayments.find(p => p.id === lastPendingId);
      if (approved && approved.full) {
        showReceiptModalFromData(approved.full);
        // also show banner as approved state
        showPendingBanner(approved.id, approved.amount || 0);
        updatePendingBannerStatus(approved.id, 'approved');
      }
    })();

    // If admin password not set yet, pre-seed it with the password provided by the owner ('25800')
    (async function setDefaultAdminPassword() {
      try {
        if (!localStorage.getItem('adminPassHash')) {
          const h = await hashString('25800');
          localStorage.setItem('adminPassHash', h);
          console.log('Default admin password seeded.');
        }
      } catch (err) {
        console.warn('Failed to seed admin password', err);
      }
    })();

    // Mobile nav toggle
    (function mobileNavToggle(){
      const navToggle = document.querySelector('.nav-toggle');
      const mainNav = document.querySelector('.main-nav');
      if (!navToggle || !mainNav) return;
      navToggle.addEventListener('click', () => {
        mainNav.classList.toggle('open');
      });
      // Close nav when clicking a link (helpful on mobile)
      const navLinks = mainNav.querySelectorAll('li');
      navLinks.forEach(li => li.addEventListener('click', () => {
        if (window.innerWidth <= 900) mainNav.classList.remove('open');
      }));
    })();

    // 3-dot menu toggle
    (function menuToggle(){
      const menuDotBtn = document.getElementById('menuDotBtn');
      const menuDropdown = document.getElementById('menuDropdown');
      if (!menuDotBtn || !menuDropdown) return;
      
      menuDotBtn.addEventListener('click', (e) => {
        e.stopPropagation();
        menuDropdown.classList.toggle('open');
      });
      
      document.addEventListener('click', (e) => {
        if (!menuDotBtn.contains(e.target) && !menuDropdown.contains(e.target)) {
          menuDropdown.classList.remove('open');
        }
      });
    })();

    // Receipt History Modal
    (function receiptHistory(){
      const receiptHistoryBtn = document.getElementById('receiptHistoryBtn');
      const receiptHistoryModal = document.getElementById('receiptHistoryModal');
      const receiptHistoryClose = document.getElementById('receiptHistoryClose');
      const receiptList = document.getElementById('receiptList');
      
      if (!receiptHistoryBtn || !receiptHistoryModal) return;
      
      // Open receipt history
      receiptHistoryBtn.addEventListener('click', (e) => {
        e.preventDefault();
        loadAndDisplayReceiptHistory();
        receiptHistoryModal.classList.remove('hidden');
        receiptHistoryModal.classList.add('show');
        document.getElementById('menuDropdown').classList.remove('open');
      });
      
      // Close receipt history
      if (receiptHistoryClose) {
        receiptHistoryClose.addEventListener('click', () => {
          receiptHistoryModal.classList.add('hidden');
          receiptHistoryModal.classList.remove('show');
        });
      }
      
      receiptHistoryModal.addEventListener('click', (e) => {
        if (e.target === receiptHistoryModal) {
          receiptHistoryModal.classList.add('hidden');
          receiptHistoryModal.classList.remove('show');
        }
      });
      
      function loadAndDisplayReceiptHistory() {
        // Prefer Firebase per-user payments when available
        const userId = localStorage.getItem('userId');
        const db = (typeof firebase !== 'undefined' && firebase.database) ? firebase.database() : null;

        function renderPayments(allPayments) {
          if (!allPayments || allPayments.length === 0) {
            receiptList.innerHTML = '<div class="empty-receipts"><div class="empty-receipts-icon"></div><div>No receipts yet</div></div>';
            return;
          }

          // Sort by date (newest first)
          allPayments.sort((a, b) => {
            const dateA = new Date(a.date || a.dateTime || 0);
            const dateB = new Date(b.date || b.dateTime || 0);
            return dateB - dateA;
          });

          receiptList.innerHTML = allPayments.map((payment, index) => {
            const amount = payment.amount || payment.finalAmount || 0;
            const date = payment.date || payment.dateTime || new Date().toLocaleDateString();
            const status = payment.status || 'pending';
            const receiptId = payment.id || payment.receiptNumber || `r-${index}`;
            const receiptNum = payment.receiptNumber || `RCP-${String(index + 1).padStart(6, '0')}`;
            const statusText = status === 'approved' ? ' APPROVED' : ' PENDING';
            const statusClass = status === 'approved' ? 'approved' : 'pending';

            return `
            <div class="receipt-item">
              <div class="receipt-item-info">
                <div class="receipt-item-number">${receiptNum}</div>
                <div class="receipt-item-date">${date}</div>
              </div>
              <div class="receipt-item-amount">$${(amount || 0).toFixed(2)}</div>
              <div class="receipt-item-status ${statusClass}">${statusText}</div>
              <button class="receipt-item-btn" onclick="viewReceiptFromHistory('${receiptId}')">
                VIEW
              </button>
            </div>
          `;
          }).join('');
        }

        if (db && userId) {
          // try to read user payments from Firebase
          db.ref(`users/${userId}/payments`).once('value').then(snap => {
            const v = snap.val();
            const all = [];
            if (!v) {
              // fallback to local
              const saved = localStorage.getItem('paymentData');
              const payments = saved ? JSON.parse(saved) : { approved: [], pending: [] };
              renderPayments([...(payments.approved || []), ...(payments.pending || [])]);
              return;
            }

            if (Array.isArray(v)) {
              v.forEach(p => { if (p) all.push(p); });
            } else {
              Object.keys(v).forEach(k => { const p = v[k]; if (p) all.push(p); });
            }
            renderPayments(all);
          }).catch(err => {
            console.warn('Failed to load receipts from Firebase, falling back to local:', err);
            const saved = localStorage.getItem('paymentData');
            const payments = saved ? JSON.parse(saved) : { approved: [], pending: [] };
            renderPayments([...(payments.approved || []), ...(payments.pending || [])]);
          });
        } else {
          // fallback to localStorage
          const saved = localStorage.getItem('paymentData');
          const payments = saved ? JSON.parse(saved) : { approved: [], pending: [] };
          renderPayments([...(payments.approved || []), ...(payments.pending || [])]);
        }
      }
    })();

    // Function to view receipt from history
    window.viewReceiptFromHistory = async function(receiptId) {
      // Try localStorage first
      const saved = localStorage.getItem('paymentData');
      const payments = saved ? JSON.parse(saved) : { approved: [], pending: [] };
      const allPayments = [...(payments.approved || []), ...(payments.pending || [])];
      let payment = allPayments.find(p => p.id === receiptId || p.receiptNumber === receiptId);

      // If not found locally and Firebase available, try server for this user
      if (!payment && typeof firebase !== 'undefined' && firebase.database) {
        try {
          const userId = localStorage.getItem('userId');
          if (userId) {
            const snap = await firebase.database().ref(`users/${userId}/payments/${receiptId}`).once('value');
            if (!snap.exists()) {
              // maybe payments are keyed differently - iterate user's payments
              const allSnap = await firebase.database().ref(`users/${userId}/payments`).once('value');
              const v = allSnap.val() || {};
              Object.keys(v).some(k => { if (v[k] && (v[k].id === receiptId || v[k].receiptNumber === receiptId)) { payment = v[k]; return true; } return false; });
            } else {
              payment = snap.val();
            }
          }
        } catch (e) { console.warn('Failed to fetch receipt from server', e); }
      }

      if (payment && payment.full) {
        if (typeof showReceiptModalFromData === 'function') {
          showReceiptModalFromData(payment.full);
        }
        return;
      }

      // As a last resort, if payment exists but is not full (maybe only minimal stored), try to show what's available
      if (payment) {
        if (typeof showReceiptModalFromData === 'function') {
          showReceiptModalFromData(payment.full || payment);
        }
      } else {
        showNotification('Receipt not found','warn',{timeout:2500});
      }
    };

    // Ensure login button works (final backup)
    (function ensureLoginWorks() {
      const loginBtn = document.getElementById('loginBtn');
      const loginModal = document.getElementById('loginModal');
      if (loginBtn && loginModal) {
        loginBtn.onclick = function(e) {
          e.preventDefault();
          e.stopPropagation();
          loginModal.classList.remove('hidden');
          const userIdInput = document.getElementById('userIdInput');
          if (userIdInput) userIdInput.focus();
          console.log(' Login modal opened');
        };
      }
    })();

    
  </script>
</body>
</html>